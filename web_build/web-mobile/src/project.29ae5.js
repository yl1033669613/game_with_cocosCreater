__require=function e(t,i,o){function s(c,a){if(!i[c]){if(!t[c]){var r=c.split("/");if(r=r[r.length-1],!t[r]){var h="function"==typeof __require&&__require;if(!a&&h)return h(r,!0);if(n)return n(r,!0);throw new Error("Cannot find module '"+c+"'")}}var l=i[c]={exports:{}};t[c][0].call(l.exports,function(e){return s(t[c][1][e]||e)},l,l.exports,e,t,i,o)}return i[c].exports}for(var n="function"==typeof __require&&__require,c=0;c<o.length;c++)s(o[c]);return s}({"2048_start":[function(e,t,i){"use strict";cc._RF.push(t,"6d066NP4OBIT60EAL8KnI0M","2048_start");var o=e("../utils.js");cc.Class({extends:cc.Component,properties:{rectPfb:{default:null,type:cc.Prefab},currentScore:{default:null,type:cc.Node},infoPanel:{default:null,type:cc.Node},infoScore:{default:null,type:cc.Node},infoBestScore:{default:null,type:cc.Node},gameWinMask:{default:null,type:cc.Node}},onLoad:function(){var e=cc.view.getVisibleSize();this.node.height=this.node.width=e.width-14;var t=this.node.getChildByName("gameShadowRect");this.ctx=t.getComponent(cc.Graphics),this.map=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.box_width=.86*this.node.width*.25,this.margin_width=.14*this.node.width*.2,this.num_color={0:"#ccc0b3",2:"#ffeecd",4:"#ffcb6a",8:"#ffa65a",16:"#ff8545",32:"#ff643f",64:"#e4451e",128:"#bd3b18",256:"#ece688",512:"#f8ec24",1024:"#42f391",2048:"#00ffae"},this.space=16,this.score=0,this.isGameOver=!1,this.bestScore=o.GD.userGameInfo.tzfeBestScore||0,this.WinTimes=o.GD.userGameInfo.tzfeWinNum||0},loop:function(e){for(var t=0;t<4;t++)for(var i=0;i<4;i++)e(t,i)},drawBgShadowRect:function(){var e=this,t=new cc.Color(255,255,255,30);e.loop(function(i,o){var s=0==o?e.margin_width:o*(e.box_width+e.margin_width)+e.margin_width,n=3==i?e.margin_width:(3-i)*(e.box_width+e.margin_width)+e.margin_width;e.ctx.lineWidth=0,e.ctx.rect(s,n,e.box_width,e.box_width),e.ctx.fillColor=t,e.ctx.fill()})},produce:function(){var e=this,t=~~(Math.random()*e.space),i=0;e.loop(function(o,s){0==e.map[o][s]&&(t==i&&(e.map[o][s]=2,e.block()),i+=1)}),e.space-=1},clearNumRects:function(){for(var e=0;e<this.node.children.length;e++)"2048RectPfb"==this.node.children[e]._name&&this.node.children[e].destroy()},block:function(){var e=this;e.clearNumRects(),e.loop(function(t,i){var o=e.map[t][i],s=e.num_color[String(o)];0!=o&&e.drawRects(0==i?e.margin_width:i*(e.box_width+e.margin_width)+e.margin_width,3==t?e.margin_width:(3-t)*(e.box_width+e.margin_width)+e.margin_width,e.box_width,s,o)})},drawRects:function(e,t,i,o,s){var n=cc.instantiate(this.rectPfb);n.width=n.height=i,n.setPosition(cc.p(e,t));var c=n.getChildByName("2048Number");n.getChildByName("2048RectBg").color=cc.hexToColor(String(o)),c.color=s<=4?cc.hexToColor("#ffb638"):cc.Color.WHITE,c.getComponent(cc.Label).string=s,this.node.addChild(n)},init:function(){for(var e=0;e<2;e++)this.produce()},move:function(e){var t=!1;if(!this.isGameOver){for(var i=0;i<4;i++){for(var o=[],s=!1,n=0;n<4;n++){var c=u(i,n)[0],a=u(i,n)[1];0!=this.map[c][a]&&(s||this.map[c][a]!=o[o.length-1]?o.push(this.map[c][a]):(this.score+=o[o.length-1]*=2,2048==o[o.length-1]&&(this.isGameOver=!0,this.showTheGamePanel(!0,this.gameWinMask),this.setWinTimes()),s=!0,this.space+=1,t||(t=!0),this.currentScore.getComponent(cc.Label).string="score:"+this.score))}for(var r=0;r<4;r++){var h=u(i,r)[0],l=u(i,r)[1];0==this.map[h][l]&&o[r]>0&&(t||(t=!0)),this.map[h][l]=isNaN(o[r])?0:o[r]}}return t&&this.space>0&&(this.produce(),t=!1),0==this.space&&this.gameOver()&&!this.isGameOver?(this.isGameOver=!0,this.infoScore.getComponent(cc.Label).string="score:"+this.score,this.setDbDataWhenScoreChange(),this.infoBestScore.getComponent(cc.Label).string="best:"+this.bestScore,void this.showTheGamePanel(!0,this.infoPanel)):void 0}function u(t,i){var o=t,s=i,n=o;return 0==e[0]&&(o=s,s=n),e[1]>0&&(o=3-o),e[0]>0&&(s=3-s),[o,s]}},gameOver:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++){var i=0==e?null:[e-1,t],o=3==t?null:[e,t+1],s=3==e?null:[e+1,t],n=0==t?null:[e,t-1];if(i&&this.map[e][t]==this.map[i[0]][i[1]])return!1;if(o&&this.map[e][t]==this.map[o[0]][o[1]])return!1;if(s&&this.map[e][t]==this.map[s[0]][s[1]])return!1;if(n&&this.map[e][t]==this.map[n[0]][n[1]])return!1}return!0},setDbDataWhenScoreChange:function(){var e=this;e.score>e.bestScore&&(e.bestScore=e.score,o.GD.updateGameScore({tzfeBestScore:e.bestScore},function(){o.GD.setUserGameInfo("tzfeBestScore",e.bestScore),console.log("\u4fdd\u5b58\u6210\u529f")}))},setWinTimes:function(){var e=this;e.WinTimes=e.WinTimes+1,o.GD.updateGameScore({tzfeWinNum:e.WinTimes},function(){o.GD.setUserGameInfo("tzfeWinNum",e.WinTimes),console.log("\u4fdd\u5b58\u6210\u529f")})},showTheGamePanel:function(e,t){e?(t.active=e,t.opacity=0,t.runAction(cc.fadeIn(.2))):t.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){t.active=e},this)))},eventHandle:function(){var e=this,t=this.node.parent,i=void 0,o=void 0,s=void 0,n=void 0;t.on(cc.Node.EventType.TOUCH_START,function(e){var t=e.getLocation();i=t.x,o=t.y,s=0,n=0},this),t.on(cc.Node.EventType.TOUCH_MOVE,function(e){var t=e.getLocation(),c=t.x,a=t.y;s=c-i,n=a-o},this),t.on(cc.Node.EventType.TOUCH_END,function(t){n<-30&&Math.abs(n/s)>2&&e.move([0,1]),n>30&&Math.abs(n/s)>2&&e.move([0,-1]),s<-30&&Math.abs(s/n)>2&&e.move([-1,0]),s>30&&Math.abs(s/n)>2&&e.move([1,0])},this)},back_game_list:function(){cc.director.loadScene("startscene")},restartGame:function(){this.clearNumRects(),this.space=16,this.score=0,this.isGameOver=!1,this.map=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.showTheGamePanel(!1,this.infoPanel),this.showTheGamePanel(!1,this.gameWinMask),this.currentScore.getComponent(cc.Label).string="score:"+this.score,this.init()},start:function(){this.drawBgShadowRect(),this.eventHandle(),this.init()}}),cc._RF.pop()},{"../utils.js":"utils"}],bird_game_start:[function(e,t,i){"use strict";cc._RF.push(t,"55419DQ6YVDL6sosruuEvaj","bird_game_start"),cc.Class({extends:cc.Component,properties:{maskLayer:{default:null,type:cc.Node}},startGame:function(){this.maskLayer.active=!0,this.maskLayer.opacity=0,this.maskLayer.color=cc.Color.BLACK,this.maskLayer.runAction(cc.sequence(cc.fadeIn(.2),cc.callFunc(function(){cc.director.loadScene("bird_game")},this)))},backGameList:function(){this.maskLayer.active=!0,this.maskLayer.opacity=0,this.maskLayer.color=cc.Color.BLACK,this.maskLayer.runAction(cc.sequence(cc.fadeIn(.2),cc.callFunc(function(){cc.director.loadScene("startscene")},this)))}}),cc._RF.pop()},{}],bird:[function(e,t,i){"use strict";cc._RF.push(t,"f7908QeEJREvazrwaMk2Uf8","bird");var o=cc.Enum({Ready:-1,Rise:-1,FreeFall:-1,Drop:-1,Dead:-1});cc.Class({statics:{State:o},extends:cc.Component,properties:{initRiseSpeed:800,gravity:1e3,state:{default:o.Ready,type:o},ground:{default:null,type:cc.Node}},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.collideWithPipe=!1,this.collideWithGround=!1},init:function(e){this.game=e,this.state=o.Ready,this.currentSpeed=0,this.anim=this.getComponent(cc.Animation),this.anim.playAdditive("birdFlapping"),this.anim.playAdditive("birdWing")},startFly:function(){this.getNextPipe(),this.anim.stop("birdFlapping"),this.rise()},getNextPipe:function(){this.nextPipe=this.game.pipeManager.getNext()},update:function(e){this.state!==o.Ready&&this.state!==o.Dead&&(this.updatePosition(e),this.updateState(e),this.detectCollision(),this.fixBirdFinalPosition())},updatePosition:function(e){(this.state===o.Rise||this.state===o.FreeFall||this.state===o.Drop)&&(this.currentSpeed-=e*this.gravity,this.node.y+=e*this.currentSpeed)},updateState:function(e){switch(this.state){case o.Rise:this.currentSpeed<0&&(this.state=o.FreeFall,this.runFallAction());break;case o.Drop:this.collideWithGround&&(this.state=o.Dead)}},detectCollision:function(){this.nextPipe&&(this.state!==o.Ready&&this.state!==o.Dead&&this.state!==o.Drop&&(this.collideWithPipe||this.collideWithGround?(this.collideWithGround?this.state=o.Dead:(this.state=o.Drop,this.runDropAction(),this.scheduleOnce(function(){},.3)),this.anim.stop(),this.game.gameOver()):this.node.x>this.nextPipe.node.x+this.nextPipe.topPipe.width&&(this.game.gainScore(),this.getNextPipe())))},fixBirdFinalPosition:function(){this.collideWithGround&&(this.node.y=this.ground.y+this.ground.height/2+this.node.width/2)},onCollisionEnter:function(e,t){"topPipe"!==e.node._name&&"bottomPipe"!==e.node._name||(this.collideWithPipe=!0),"ground"===e.node._name&&(this.collideWithGround=!0)},rise:function(){this.state=o.Rise,this.currentSpeed=this.initRiseSpeed,this.runRiseAction()},runRiseAction:function(){this.node.stopAllActions();var e=cc.rotateTo(.3,-30).easing(cc.easeCubicActionOut());this.node.runAction(e)},runFallAction:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.6;this.node.stopAllActions();var t=cc.rotateTo(e,90).easing(cc.easeCubicActionIn());this.node.runAction(t)},runDropAction:function(){this.currentSpeed>0&&(this.currentSpeed=0),this.runFallAction(.4)}}),cc._RF.pop()},{}],block_row:[function(e,t,i){"use strict";cc._RF.push(t,"77d5bHMiEpJP6NXhtSfknpY","block_row"),cc.Class({extends:cc.Component,properties:{colItems:{default:[],type:cc.Node}},onLoad:function(){var e=cc.director.getVisibleSize();this.node.width=e.width,this.node.height=e.height/4;for(var t=this.node.width/4,i=0;i<this.colItems.length;i++)this.colItems[i].setPositionX(i*t+1),this.colItems[i].width=t-2;this.gm=this.node.parent.getComponent("dtwb_game");for(var o=0;o<this.colItems.length;o++)this.colItems[o].on(cc.Node.EventType.TOUCH_START,this.handleClick,this)},update:function(e){1==this.gm.gameState&&this.node.y<=0&&(2==this.state?(this.isFirst&&(this.colItems[this.blackIdx].children[0].active=!1),this.gm.rowNodeList.shift(),this.gm.createMoveRow(!1),this.gm.backObjPool(this.node)):this.gm.gameOver())},init:function(e){this.state=1,this.redIdx=-1,this.blackIdx=this.getBlack(),this.isFirst=e,this.setNormal(),e&&(this.colItems[this.blackIdx].children[0].active=!0)},getBlack:function(){var e=Math.floor(Math.random()*(this.colItems.length-.4));return this.colItems[e].color=cc.Color.BLACK,e},setBlockGray:function(e){this.colItems[e].runAction(cc.tintTo(.15,134,134,134,255))},setBlockRed:function(e){this.colItems[e].runAction(cc.tintTo(.15,255,0,0,255))},setNormal:function(){for(var e=0;e<this.colItems.length;e++)e!=this.blackIdx&&(this.colItems[e].color=cc.Color.WHITE)},handleClick:function(e){var t=parseInt(e.target.name.split("_")[1])-1;0==this.gm.gameState&&this.isFirst&&this.blackIdx==t&&(this.gm.gameState=1,this.gm.startRowAction()),1==this.gm.gameState&&(this.blackIdx==t?1==this.state&&(this.state=2,this.setBlockGray(this.blackIdx),this.gm.updateScore()):(this.redIdx=t,this.setBlockRed(this.redIdx),this.gm.gameOver()))}}),cc._RF.pop()},{}],buff_group:[function(e,t,i){"use strict";cc._RF.push(t,"b74e5qs5WFHl4UVLD1Y33lz","buff_group");var o=e("globals"),s=cc.Class({name:"buffG",properties:{name:"",initPoolCount:0,probability:.5,prefab:{default:null,type:cc.Prefab}}});cc.Class({extends:cc.Component,properties:{buffG:{default:[],type:s}},onLoad:function(){this.curState=o.commonInfo.gameState.start,o.common.batchInitObjPool(this,this.buffG)},createHeroBuff:function(e){for(var t=e.getComponent("enemy"),i=0;i<this.buffG.length;i++)t.buffType==this.buffG[i].name&&Math.random()<=this.buffG[i].probability&&this.getNewBuff(this.buffG[i],e)},getNewBuff:function(e,t){var i=e.name+"Pool",s=o.common.genNewNode(this[i],e.prefab,this.node),n=t.getPosition(),c=cc.p(n.x,n.y);s.setPosition(c),s.getComponent("buff").poolName=i},resumeAction:function(){this.enabled=!0,this.curState=o.commonInfo.gameState.start},pauseAction:function(){this.enabled=!1,this.curState=o.commonInfo.gameState.pause},buffDied:function(e){var t=e.getComponent("buff").poolName;o.common.backObjPool(this,t,e)}}),cc._RF.pop()},{globals:"globals"}],buff:[function(e,t,i){"use strict";cc._RF.push(t,"1e7a0zfIuJA+Kn9DAfY5544","buff");var o=e("globals");cc.Class({extends:cc.Component,properties:{xMinSpeed:0,xMaxSpeed:0,yMinSpeed:0,yMaxSpeed:0},onLoad:function(){this.xSpeed=Math.random()*(this.xMaxSpeed-this.xMinSpeed)+this.xMinSpeed,Math.ceil(10*Math.random())<5&&(this.xSpeed=-this.xSpeed),this.ySpeed=Math.random()*(this.yMaxSpeed-this.yMinSpeed)+this.yMinSpeed,this.buffGroup=this.node.parent.getComponent("buff_group")},onCollisionEnter:function(e,t){this.buffGroup.buffDied(t.node)},update:function(e){if(this.buffGroup.curState==o.commonInfo.gameState.start){var t=this.node.x,i=this.node.y;t+=e*this.xSpeed,i+=e*this.ySpeed,t<=-(this.node.parent.width-this.node.width)/2?(t=(this.node.parent.width-this.node.width)/2,this.xSpeed=-this.xSpeed):t>=(this.node.parent.width-this.node.width)/2?(t=(this.node.parent.width-this.node.width)/2,this.xSpeed=-this.xSpeed):this.node.x=t,this.node.y=i,this.node.y<-this.node.parent.height/2-this.node.height/2&&this.buffGroup.buffDied(this.node)}}}),cc._RF.pop()},{globals:"globals"}],bullet_group:[function(e,t,i){"use strict";cc._RF.push(t,"6f83eOsOMRPIL5rlCwbn7ut","bullet_group");var o=e("globals"),s=cc.Class({name:"bPosition",properties:{xAxis:{default:""},yAxis:{default:""}}}),n=cc.Class({name:"bulletInfinite",properties:{name:"",freqTime:0,initPoolCount:0,prefab:cc.Prefab,position:{default:[],type:s}}}),c=cc.Class({name:"bulletFiniteG",extends:n,properties:{finiteTime:0,orginName:""}});cc.Class({extends:cc.Component,properties:{bulletInfinite:{default:null,type:n},bulletFiniteG:{default:[],type:c},hero:{default:null,type:cc.Node}},onLoad:function(){this.curState=o.commonInfo.gameState.none,this.isDeadBullet=!1,o.common.initObjPool(this,this.bulletInfinite),o.common.batchInitObjPool(this,this.bulletFiniteG)},startAction:function(){this.curState=o.commonInfo.gameState.start,this.getNewbullet(this.bulletInfinite),this.bICallback=function(){this.getNewbullet(this.bulletInfinite),this.isDeadBullet=!1}.bind(this),this.schedule(this.bICallback,this.bulletInfinite.freqTime)},pauseAction:function(){this.enabled=!1,this.curState=o.commonInfo.gameState.pause},resumeAction:function(){this.enabled=!0,this.curState=o.commonInfo.gameState.start},changeBullet:function(e){if(!this.isDeadBullet){this.unschedule(this.bICallback),this.unschedule(this.bFCallback);for(var t=0;t<this.bulletFiniteG.length;t++)if(this.bulletFiniteG[t].orginName==e){this.bFCallback=function(e){this.getNewbullet(this.bulletFiniteG[e]),this.isDeadBullet=!0}.bind(this,t),this.schedule(this.bFCallback,this.bulletFiniteG[t].freqTime,this.bulletFiniteG[t].finiteTime);var i=this.bulletFiniteG[t].freqTime*this.bulletFiniteG[t].finiteTime;this.schedule(this.bICallback,this.bulletInfinite.freqTime,cc.macro.REPEAT_FOREVER,i)}}},getNewbullet:function(e){for(var t=e.name+"Pool",i=0;i<e.position.length;i++){var s=o.common.genNewNode(this[t],e.prefab,this.node),n=this.getBulletPostion(e.position[i]);s.setPosition(n),s.getComponent("bullet").poolName=t}},getBulletPostion:function(e){var t=this.hero.getPosition(),i=t.x+parseFloat(e.xAxis),o=t.y+parseFloat(e.yAxis);return cc.p(i,o)},bulletDied:function(e){var t=e.getComponent("bullet").poolName;o.common.backObjPool(this,t,e)}}),cc._RF.pop()},{globals:"globals"}],bullet:[function(e,t,i){"use strict";cc._RF.push(t,"6edb1awKr1Jvo6CI6YOeDfp","bullet");var o=e("globals");cc.Class({extends:cc.Component,properties:{xSpeed:0,ySpeed:0,hpDrop:0},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.bulletGroup=this.node.parent.getComponent("bullet_group")},onCollisionEnter:function(e,t){this.bulletGroup.bulletDied(t.node)},update:function(e){this.bulletGroup.curState==o.commonInfo.gameState.start&&(this.node.x+=e*this.xSpeed,this.node.y+=e*this.ySpeed,this.node.y>this.node.parent.height/2&&this.bulletGroup.bulletDied(this.node))}}),cc._RF.pop()},{globals:"globals"}],circle_group:[function(e,t,i){"use strict";cc._RF.push(t,"07104eeqttE24KefBV7t9oC","circle_group");var o=["255/0/0/255","255/144/0/255","255/255/0/255","0/255/0/255","0/255/255/255","0/0/255/255","114/0/255/255"],s=e("../utils.js");cc.Class({extends:cc.Component,properties:{initBorderR:22,initCenterR:30,intervalMul:.5,tapMax:3.6,gameOverScore:-30,compStart:{default:null,type:e("ftc_start")},circleItem:{default:null,type:cc.Prefab},gameBg:{default:null,type:cc.Node},scoreLabel:{default:null,type:cc.Label},comboLabel:{default:null,type:cc.Label},maskBestScore:{default:null,type:cc.Label},maskBestCombo:{default:null,type:cc.Label}},onLoad:function(){this.circlesCreateState=!1,this.combo=0,this.score=0,this.bestComboIsUpdate=!1,this.bestScore=s.GD.userGameInfo.ftcBestScore||0,this.bestCombo=s.GD.userGameInfo.ftcBestCombo||0,this.maskBestScore.string="Best score: "+this.bestScore,this.maskBestCombo.string="Best combo: "+this.bestCombo,this.circleGroup=[],this.gameOver=!1,this.initObjPool()},startCreateCircles:function(){this.unscheduleAllCallbacks(),this.circlesCreateState=!1,this.combo=0,this.score=0,this.scoreLabel.string="SCORE: "+this.score,this.comboLabel.string=0,this.comboLabel.node.opacity=0,this.gameOver=!1,this.circleGroup=[],this.getRandomCircles()},initObjPool:function(){this.circleItemObjPool=new cc.NodePool;for(var e=0;e<15;++e){var t=cc.instantiate(this.circleItem);this.circleItemObjPool.put(t)}},genNewCircle:function(e,t,i){var o=null;return o=e.size()>0?e.get():cc.instantiate(t),i.addChild(o),o},backObjPool:function(e){this.circleItemObjPool.put(e)},getRandomCircles:function(){var e=this,t=Math.floor(Math.random()*(o.length+.4-3)+3);e.circlesCreateState=!0,e.loadingBgAni(t);for(var i=[],s=o.slice(0),n=0;n<t;n++){var c=Math.floor(Math.random()*(o.length-n));i.push(s[c]),s[c]=s[o.length-n-1]}for(var a=0;a<t;){for(var r=(2*Math.random()-1)*(e.node.width/2-(e.initCenterR+2)),h=(2*Math.random()-1)*(e.node.height/2-(e.initCenterR+2)-e.initCenterR),l=!1,u=Math.sqrt(2*Math.pow(2*e.initCenterR,2)),d=0;d<e.circleGroup.length;d++){if(Math.abs(Math.sqrt(Math.pow(r-e.circleGroup[d].x,2)+Math.pow(h-e.circleGroup[d].y,2)))<u){l=!0;break}}l||(e.circleGroup.push({color:i[a],x:r,y:h}),a++)}for(var p=function(t){e.scheduleOnce(function(){if(e.circlesCreateState){var i=e.genNewCircle(e.circleItemObjPool,e.circleItem,e.node),o=cc.v2(e.circleGroup[t].x,e.circleGroup[t].y);i.setPosition(o),i.scale=0;var s=i.getComponent("circle_item"),n=Math.floor(Math.random()*(e.tapMax-1)+1);s.itemCircleInit(e.circleGroup[t].color,n,e.initBorderR,e.initCenterR);var c=cc.scaleTo(1.1,1,1).easing(cc.easeExponentialOut(1.1));if(i.runAction(c),t==e.circleGroup.length-1){e.circlesCreateState=!1;for(var a=e.node.children,r=0;r<a.length;r++)a[r].getComponent("circle_item").itemCircleInitCount(r)}}},(t+1)*e.intervalMul)},f=0;f<e.circleGroup.length;f++)p(f)},loadingBgAni:function(e){var t,i=(e+1)*this.intervalMul;t=cc.sequence(cc.tintTo(.3,90,146,185),cc.tintTo(i-.3,255,255,255)),this.gameBg.runAction(t)},updateComboAndScore:function(e,t){e?(this.score+=t,this.combo++,this.combo>this.bestCombo&&(this.bestComboIsUpdate=!0,this.bestCombo=this.combo),this.combo>0&&this.combo%10==0&&(this.score+=this.combo/10)):(this.combo=0,this.score-=t),this.renderComboAndScoreNum(),this.score<=this.gameOverScore&&this.handleGameOver()},renderComboAndScoreNum:function(){this.scoreLabel.string="SCORE: "+this.score,this.comboLabel.string=this.combo,this.combo?(this.comboLabel.node.scale=1.4,this.comboLabel.node.opacity=0,this.comboLabel.node.runAction(cc.spawn(cc.scaleTo(.6,1,1).easing(cc.easeExponentialOut(.6)),cc.fadeTo(.6,200)))):this.comboLabel.node.runAction(cc.fadeOut(.8))},updateCircleGroup:function(e,t){var i=[];if(!this.gameOver){for(var o=0;o<this.circleGroup.length;o++)if(this.circleGroup[o].color==e){var s=void 0;if((i=(s=this.circleGroup.splice(0,o+1)).splice(0,s.length-1)).length>0)for(var n=this.node.children,c=0;c<n.length;c++)for(var a=n[c].getComponent("circle_item"),r=0;r<i.length;r++)i[r].color==a.color&&a.noTouchHideAnimation(!0);break}this.updateComboAndScore(!(i.length>0)&&t,i.length>0?i.length:1),0!=this.circleGroup.length||this.gameOver||this.getRandomCircles()}},handleGameOver:function(){if(!this.gameOver){this.gameOver=!0,this.circlesCreateState=!1,this.updateScore(),this.updateCombo(),this.compStart.showGameMask(!0);for(var e=this.node.children,t=0;t<e.length;t++)for(var i=e[t].getComponent("circle_item"),o=0;o<this.circleGroup.length;o++)this.circleGroup[o].color==i.color&&i.noTouchHideAnimation(!0)}},updateScore:function(){var e=this;e.score>e.bestScore&&(e.bestScore=e.score,this.maskBestScore.string="Best score: "+this.bestScore,s.GD.updateGameScore({ftcBestScore:e.bestScore},function(){s.GD.setUserGameInfo("ftcBestScore",e.bestScore),console.log("\u5206\u6570\u4fdd\u5b58\u6210\u529f")}))},updateCombo:function(){var e=this;e.bestComboIsUpdate&&(this.maskBestCombo.string="Best combo: "+this.bestCombo,s.GD.updateGameScore({ftcBestCombo:e.bestCombo},function(){s.GD.setUserGameInfo("ftcBestCombo",e.bestCombo),console.log("\u8fde\u51fb\u4fdd\u5b58\u6210\u529f")}))}}),cc._RF.pop()},{"../utils.js":"utils",ftc_start:"ftc_start"}],circle_item:[function(e,t,i){"use strict";cc._RF.push(t,"0aa524r4KVJToVOLcFtzwfb","circle_item"),cc.Class({extends:cc.Component,properties:{fadeSpeed:.085,circleMoveSpeed:.2,finBorderR:95,itemInitCount:3,cirHideMul:.8,planetR:2.5,drawCtn:{default:null,type:cc.Node},centerNum:{default:null,type:cc.Label},drawPlanet:{default:null,type:cc.Node}},onLoad:function(){this.color="",this.animationCircleR=null,this.circleGroupO=cc.find("Canvas/ftcGameComtainer/circleGroup").getComponent("circle_group"),this.ctx=this.drawCtn.getComponent(cc.Graphics),this.planetCtx=this.drawPlanet.getComponent(cc.Graphics),this.node.on(cc.Node.EventType.TOUCH_START,this.touchHandle,this),this.isCollision=!1,cc.director.getCollisionManager().enabled=!0},itemCircleInit:function(e,t,i,o){this.color=e,this.tapNum=t,this.cirBorderR=i,this.cirCenterR=o,this.unscheduleAllCallbacks(),this.isTouch=!1,this.centerNum.node.opacity=255,this.centerNum.string=this.tapNum,this.itemCount=this.itemInitCount,this.circleMoveObj={angle:this.random(0,2*Math.PI),tickMax:this.random(50,400),tick:0},this.planetArr=[],this.planetCtx.clear();for(var s=0;s<this.tapNum;s++){var n={ang:this.random(0,2*Math.PI),speed:this.random(.008,.03),r:this.cirCenterR+this.planetR+s*this.planetR*2+3,opc:255-65*s};this.drawPlanetPoint(n.ang,n.r),this.planetArr.push(n)}this.circleActive=!0,this.drawCircleItem(this.color,this.cirBorderR,this.cirCenterR)},itemCircleInitCount:function(e){this.itemCount=this.itemCount+e*this.cirHideMul,this.circleCountCb=function(e){this.circleActive=!1,this.noTouchHideAnimation()}.bind(this),this.scheduleOnce(this.circleCountCb,this.itemCount)},touchHandle:function(e){this.circleGroupO.circlesCreateState||(this.tapNum>0&&(this.tapNum--,this.planetArr.splice(this.planetArr.length-1,1),this.centerNum.string=this.tapNum),this.circleActive&&0==this.tapNum&&(this.planetCtx.clear(),this.hideCenterNum(),this.isTouch=!0,this.circleActive=!1,this.unschedule(this.circleCountCb),this.circleGroupO.updateCircleGroup(this.color,!0)))},drawCircleItem:function(e,t,i,o){var s,n,c=e.split("/");n=s=this.node.width/2,this.ctx.clear(),this.ctx.strokeColor=new cc.Color(c[0],c[1],c[2],o),this.ctx.lineWidth=8,this.ctx.circle(n,s,t),this.ctx.stroke(),this.ctx.lineWidth=1,this.ctx.circle(n,s,i+2),this.ctx.stroke(),this.ctx.close(),this.ctx.fillColor=new cc.Color(c[0],c[1],c[2],c[3]),this.ctx.circle(n,s,i),this.ctx.fill()},drawCircleItemAnimationTouched:function(e,t,i){var o=e,s=t,n=i;return o+=(this.finBorderR-o)*this.fadeSpeed,s-=s*this.fadeSpeed,n-=n*this.fadeSpeed,this.drawCircleItem(this.color,o,s,n),o<this.finBorderR-.1?{bR:o,cR:s,opc:n}:(this.isTouch=!1,this.removeThisCircle(this.node),"")},noTouchHideAnimation:function(e){var t=this;this.unschedule(this.circleCountCb),e||this.circleGroupO.updateCircleGroup(this.color,!1);var i=cc.sequence(cc.scaleTo(1.1,0,0).easing(cc.easeExponentialOut(1.1)),cc.callFunc(function(){t.removeThisCircle(t.node)},this));this.node.runAction(i)},hideCenterNum:function(){this.centerNum.node.runAction(cc.fadeOut(.2))},removeThisCircle:function(e){this.circleGroupO.backObjPool(e)},updateCirclesPos:function(){var e=this.node.parent.width,t=this.node.parent.height;this.circleMoveObj.tick++,this.node.x+=Math.cos(this.circleMoveObj.angle)*this.circleMoveSpeed,this.node.y+=Math.sin(this.circleMoveObj.angle)*this.circleMoveSpeed,this.node.x<-e/2+this.node.width/2?this.circleMoveObj.angle=this.getWallCollisionDir(this.circleMoveObj.angle,"left"):this.node.x>e/2-this.node.width/2&&(this.circleMoveObj.angle=this.getWallCollisionDir(this.circleMoveObj.angle,"right")),this.node.y<-t/2+this.node.height/2?this.circleMoveObj.angle=this.getWallCollisionDir(this.circleMoveObj.angle,"bottom"):this.node.y>t/2-this.node.height&&(this.circleMoveObj.angle=this.getWallCollisionDir(this.circleMoveObj.angle,"top")),this.circleMoveObj.tick>this.circleMoveObj.tickMax&&(this.circleMoveObj.angle=this.random(0,2*Math.PI),this.circleMoveObj.tick=0,this.circleMoveObj.tickMax=this.random(100,600))},getWallCollisionDir:function(e,t){return 0==e?Math.PI:e==Math.PI?0:e==2*Math.PI?Math.PI:"left"==t||"right"==t?e<Math.PI?Math.PI-e:3*Math.PI-e:2*Math.PI-e},onCollisionEnter:function(e,t){this.circleMoveObj.angle<Math.PI?this.circleMoveObj.angle=Math.PI+this.circleMoveObj.angle:this.circleMoveObj.angle=this.circleMoveObj.angle-Math.PI,this.isCollision=!0},random:function(e,t){return Math.random()*(t-e)+e},drawPlanetPoint:function(e,t,i){var o,s,n,c=this.color.split("/"),a=o=this.node.width/2;s=o+t*Math.cos(e),n=a+t*Math.sin(e),this.planetCtx.fillColor=new cc.Color(c[0],c[1],c[2],i),this.planetCtx.circle(s,n,this.planetR),this.planetCtx.fill()},updatePlanetPointMove:function(){this.planetCtx.clear();for(var e=0;e<this.planetArr.length;e++)this.planetArr[e].ang+=this.planetArr[e].speed,this.drawPlanetPoint(this.planetArr[e].ang,this.planetArr[e].r,this.planetArr[e].opc)},update:function(e){if(this.isTouch){var t=this.animationCircleR?this.animationCircleR.bR:this.cirBorderR,i=this.animationCircleR?this.animationCircleR.cR:this.cirCenterR,o=this.animationCircleR?this.animationCircleR.opc:255;this.animationCircleR=this.drawCircleItemAnimationTouched(t,i,o)}this.circleActive&&(this.updateCirclesPos(),this.updatePlanetPointMove())}}),cc._RF.pop()},{}],common:[function(e,t,i){"use strict";cc._RF.push(t,"dafb86Bq49CmKhNRxFetUy1","common");var o=e("globals"),s=e("../utils"),n=cc.Enum({none:0,start:1,stop:2,pause:3}),c=cc.Class({extends:cc.Component,properties:{},statics:{gameState:n},onLoad:function(){o.commonInfo=c,o.common=this,this.batchInitObjPool=s.batchInitObjPool,this.initObjPool=s.initObjPool,this.genNewNode=s.genNewNode,this.backObjPool=s.backObjPool}});cc._RF.pop()},{"../utils":"utils",globals:"globals"}],crane_rotate:[function(e,t,i){"use strict";cc._RF.push(t,"059caoIKCVFfYa01kH08GoG","crane_rotate"),cc.Class({extends:cc.Component,properties:function(){return{blockTmpCtn:{default:null,type:cc.Node},mainGm:{default:null,type:e("skyscraper_game")}}},onLoad:function(){this.speed=3,this.angle=8},craneStrRotate:function(){this.node.stopAllActions(),this.blockTmpCtn.stopAllActions();var e=cc.repeatForever(cc.sequence(cc.rotateTo(0,-this.angle).easing(cc.easeQuadraticActionInOut()),cc.rotateTo(this.speed/2,this.angle).easing(cc.easeQuadraticActionInOut()),cc.rotateTo(this.speed/2,-this.angle).easing(cc.easeQuadraticActionInOut())));this.node.runAction(e);var t=cc.repeatForever(cc.sequence(cc.rotateTo(0,this.angle).easing(cc.easeQuadraticActionInOut()),cc.rotateTo(this.speed/2,-this.angle).easing(cc.easeQuadraticActionInOut()),cc.rotateTo(this.speed/2,this.angle).easing(cc.easeQuadraticActionInOut())));this.blockTmpCtn.runAction(t)},switchDifficulty:function(){switch(this.mainGm.succeedPutCount){case 10:this.speed=2.5,this.angle=15,this.craneStrRotate();break;case 25:this.speed=2,this.angle=20,this.craneStrRotate();break;case 50:this.speed=1.8,this.angle=30,this.craneStrRotate();break;case 100:this.speed=1.2,this.angle=35,this.craneStrRotate()}}}),cc._RF.pop()},{skyscraper_game:"skyscraper_game"}],draw_animation_bg:[function(e,t,i){"use strict";cc._RF.push(t,"ce92bwO2b9O7YhkkPUw9i/i","draw_animation_bg"),cc.Class({extends:cc.Component,properties:{circlesNum:10,r:163,g:163,b:163,type:1},onLoad:function(){this.ctx=this.node.getComponent(cc.Graphics),this.circles=[],this.speed=1.5,this.tick=0;for(var e=0;e<this.circlesNum;e++){var t={cx:this.random(.05*this.node.width,.95*this.node.width),cy:this.random(.05*this.node.height,.95*this.node.height),angle:this.random(0,2*Math.PI),r:this.random(1,20),tickMax:this.random(50,400),tick:0,alpha:this.random(10,70)};this.circles.push(t)}},createCircle:function(e){this.ctx.arc(e.cx,e.cy,e.r,0,2*Math.PI),this.ctx.fillColor=new cc.Color(this.r,this.g,this.b,e.alpha),this.ctx.fill()},updateDirection:function(e){e.tick++,e.cx+=Math.cos(e.angle)*this.speed/10,e.cy+=Math.sin(e.angle)*this.speed/10,e.cx<0?e.cx=0:e.cx>this.node.width&&(e.cx=this.node.width),e.cy<0?e.cy=0:e.cy>this.node.height&&(e.cy=this.node.height),e.tick>e.tickMax&&(e.angle=this.random(0,2*Math.PI),e.tick=0,e.tickMax=this.random(50,400)),this.createCircle(e)},random:function(e,t){return Math.random()*(t-e)+e},update:function(e){this.ctx.clear();for(var t=0;t<this.circles.length;t++)this.updateDirection(this.circles[t])}}),cc._RF.pop()},{}],draw_needles:[function(e,t,i){"use strict";cc._RF.push(t,"247f98qe3BPPLYsWNb4vnyw","draw_needles"),cc.Class({extends:cc.Component,properties:{needleDrawContent:{default:null,type:cc.Node},numText:{default:null,type:cc.Node},isRotate:!0,speed:10},onLoad:function(){this.ctx=this.needleDrawContent.getComponent(cc.Graphics),this.startRotate=0,this.rotateAniObj=""},start:function(){this.ctx.moveTo(9,0),this.ctx.lineTo(9,80),this.ctx.stroke(),this.ctx.circle(9,9,9),this.ctx.fill(),this.rotateAniObj=this.numTextRotate()},numTextRotate:function(){if(this.isRotate){var e=cc.repeatForever(cc.sequence(cc.rotateBy(0,0),cc.rotateBy(this.speed,-360)));return this.numText.runAction(e),e}},stopNeedleAction:function(){this.rotateAniObj&&this.node.stopAction(this.rotateAniObj)}}),cc._RF.pop()},{}],dtwb_game:[function(e,t,i){"use strict";cc._RF.push(t,"b62a4ZBtf9OcoTuhec6hJ2a","dtwb_game");var o=e("../utils.js");cc.Class({extends:cc.Component,properties:{scoreLabel:{default:null,type:cc.Label},rowPfb:{default:null,type:cc.Prefab},gameOverMask:{default:null,type:cc.Node},maskCurrScore:{default:null,type:cc.Label},bestScore:{default:null,type:cc.Label},initSpeed:7,maxSpeed:13},onLoad:function(){this.gameState=0,this.rowNodeList=[],this.speed=0,this.score=0,this.bestSco=o.GD.userGameInfo.donttWhiteBlockScore||0,this.rowPool=new cc.NodePool;for(var e=0;e<10;++e){var t=cc.instantiate(this.rowPfb);this.rowPool.put(t)}},start:function(){this.updateUi();for(var e=0;e<6;e++)this.createMoveRow(0==e)},update:function(e){var t=this;1==this.gameState&&this.rowNodeList.forEach(function(e){e.setPositionY(e.getPositionY()-t.speed)})},updateScore:function(){this.score++,0!=this.score&&!(this.score%10)&&this.speed<this.maxSpeed&&(this.speed+=(this.maxSpeed-this.initSpeed)/40),this.updateUi()},updateUi:function(){this.scoreLabel.string=this.score,this.maskCurrScore.string="Current score: "+this.score,this.bestScore.string="Best score: "+this.bestSco},createMoveRow:function(e){var t=void 0,i=this.node.height/4,o=this.rowNodeList.length>0?this.rowNodeList[this.rowNodeList.length-1]:null;t=this.rowPool.size()>0?this.rowPool.get():cc.instantiate(this.rowPfb),o?t.setPosition(0,o.y+i):t.setPosition(0,i),this.node.addChild(t),t.getComponent("block_row").init(e),this.rowNodeList.push(t)},startRowAction:function(){this.speed=this.initSpeed},gameOver:function(){this.gameState=2,this.score>this.bestSco&&(this.bestSco=this.score,this.updateUi(),this.upadteBestScore()),this.showGameOverMask(!0)},showGameOverMask:function(e){var t=this,i=void 0;e?(this.gameOverMask.active=!0,this.gameOverMask.opacity=0,i=cc.fadeIn(.2)):i=cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){t.gameOverMask.active=!1},this)),this.gameOverMask.runAction(i)},backObjPool:function(e){this.rowPool.put(e)},backStartPage:function(){cc.director.loadScene("dontt_white_block_start")},restartGame:function(){var e=this;this.showGameOverMask(!1),this.rowNodeList.forEach(function(t){e.rowPool.put(t)}),this.rowNodeList=[],this.gameState=0,this.speed=0,this.score=0,this.updateUi();for(var t=0;t<6;t++)this.createMoveRow(0==t)},upadteBestScore:function(){var e=this;o.GD.updateGameScore({donttWhiteBlockScore:e.bestSco},function(){o.GD.setUserGameInfo("donttWhiteBlockScore",e.bestSco),console.log("\u4fdd\u5b58\u6210\u529f")})}}),cc._RF.pop()},{"../utils.js":"utils"}],dtwb_start_page:[function(e,t,i){"use strict";cc._RF.push(t,"9a20f4WBv9Pkaf28axbh8x4","dtwb_start_page"),cc.Class({extends:cc.Component,properties:{},backTheGameList:function(){cc.director.loadScene("startscene")},startGame:function(){cc.director.loadScene("dontt_white_block")}}),cc._RF.pop()},{}],enemy_bullet_group:[function(e,t,i){"use strict";cc._RF.push(t,"51403nFSaJHcbyvfSLBkv/e","enemy_bullet_group");var o=e("globals"),s=cc.Class({name:"enemyBPosition",properties:{xAxis:{default:""},yAxis:{default:""}}}),n=cc.Class({name:"enemybulletIfe",properties:{name:"",freqTime:0,initPoolCount:0,prefab:cc.Prefab,position:{default:[],type:s}}});cc.Class({extends:cc.Component,properties:{enemybulletIfe:{default:null,type:n}},onLoad:function(){this.curState=o.commonInfo.gameState.start,o.common.initObjPool(this,this.enemybulletIfe)},enemyOpenFire:function(e){this.getNewbullet(this.enemybulletIfe,e)},pauseAction:function(){this.enabled=!1,this.curState=o.commonInfo.gameState.pause},resumeAction:function(){this.enabled=!0,this.curState=o.commonInfo.gameState.start},getNewbullet:function(e,t){for(var i=e.name+"Pool",s=0;s<e.position.length;s++){var n=o.common.genNewNode(this[i],e.prefab,this.node),c=this.getBulletPostion(e.position[s],t);n.setPosition(c);var a=n.getComponent("enemy_bullet");a.poolName=i,a.ySpeed=t.getComponent("enemy").ySpeed-50}},getBulletPostion:function(e,t){var i=t.getPosition(),o=i.x+parseFloat(e.xAxis),s=i.y+parseFloat(e.yAxis);return cc.p(o,s)},bulletDied:function(e){var t=e.getComponent("enemy_bullet").poolName;o.common.backObjPool(this,t,e)}}),cc._RF.pop()},{globals:"globals"}],enemy_bullet:[function(e,t,i){"use strict";cc._RF.push(t,"c22a8QIp/9CZoB+D4LOwHaB","enemy_bullet");var o=e("globals");cc.Class({extends:cc.Component,properties:{xSpeed:0,ySpeed:0,hpDrop:0},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.enemyBulletGroup=this.node.parent.getComponent("enemy_bullet_group")},onCollisionEnter:function(e,t){"hero"!=e.node.group&&"heroBullet"!=e.node.group||this.enemyBulletGroup.bulletDied(this.node)},update:function(e){this.enemyBulletGroup.curState==o.commonInfo.gameState.start&&(this.node.x+=e*this.xSpeed,this.node.y+=e*this.ySpeed,this.node.y<-this.node.parent.height/2&&this.enemyBulletGroup.bulletDied(this.node))}}),cc._RF.pop()},{globals:"globals"}],enemy_collision:[function(e,t,i){"use strict";cc._RF.push(t,"2877b3BKe5Olp0mpEKGYKE6","enemy_collision"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){cc.director.getCollisionManager().enabled=!0},onCollisionEnter:function(e,t){if("enemy"==t.node.group){var i=this.node.parent.getComponent("enemy");if("heroBullet"==e.node.group){var o=e.node.getComponent("bullet");if(!(i.hP>0))return;return i.hP-=o.hpDrop,void(i.hP<=0&&(this.node.group="default",i.enemyOver()))}if("hero"==e.node.group)return i.hP=0,void i.enemyOver("isHero")}}}),cc._RF.pop()},{}],enemy_group:[function(e,t,i){"use strict";cc._RF.push(t,"12a18jIxsdOhLXnU3rLfdwW","enemy_group");var o=e("globals"),s=cc.Class({name:"enemyG",properties:{name:"",freqTime:0,initPoolCount:0,prefab:cc.Prefab}});cc.Class({extends:cc.Component,properties:{enemyG:{default:[],type:s},main:{default:null,type:e("main")}},onLoad:function(){this.curState=o.commonInfo.gameState.none,o.common.batchInitObjPool(this,this.enemyG)},startAction:function(){this.curState=o.commonInfo.gameState.start;for(var e=0;e<this.enemyG.length;++e){var t=this.enemyG[e].freqTime,i="callback_"+e;this[i]=function(e){this.getNewEnemy(this.enemyG[e])}.bind(this,e),this.schedule(this[i],t)}},resumeAction:function(){this.enabled=!0,this.curState=o.commonInfo.gameState.start},pauseAction:function(){this.enabled=!1,this.curState=o.commonInfo.gameState.pause},getNewEnemy:function(e){var t=e.name+"Pool",i=o.common.genNewNode(this[t],e.prefab,this.node),s=this.getNewEnemyPositon(i);i.setPosition(s),i.getComponent("enemy").poolName=t,i.getComponent("enemy").init()},getNewEnemyPositon:function(e){var t=(2*Math.random()-1)*(this.node.parent.width/2-e.width/2),i=this.node.parent.height/2+e.height/2;return cc.v2(t,i)},enemyDied:function(e,t){var i=e.getComponent("enemy").poolName;o.common.backObjPool(this,i,e),parseInt(t)>0&&this.main.gainScore(t)},getScore:function(){return this.main.getScore()}}),cc._RF.pop()},{globals:"globals",main:"main"}],enemy:[function(e,t,i){"use strict";cc._RF.push(t,"1113d3cqjhDzZumRpyV5Km2","enemy");var o=e("globals");cc.Class({extends:cc.Component,properties:{xMinSpeed:0,xMaxSpeed:0,yMinSpeed:0,yMaxSpeed:0,initHP:0,score:0,enemyType:1,enemyBulletFreq:5,heroDropHp:5,initSize:30,buffType:"none",nodeCollision:{default:null,type:cc.Node},texturePic:{default:null,type:cc.Node},ptcSys1:{default:null,type:cc.ParticleSystem},ptcSys2:{default:null,type:cc.ParticleSystem}},onLoad:function(){this.xSpeed=Math.random()*(this.xMaxSpeed-this.xMinSpeed)+this.xMinSpeed,this.xMaxSpeed&&Math.ceil(10*Math.random())<5&&(this.xSpeed=-this.xSpeed),this.ySpeed=Math.random()*(this.yMaxSpeed-this.yMinSpeed)+this.yMinSpeed,this.enemyGroup=this.node.parent.getComponent("enemy_group"),this.enemyBulletGroup=cc.find("Canvas/background/enemyBulletGroup").getComponent("enemy_bullet_group"),this.buffGroup=cc.find("Canvas/background/buffGroup").getComponent("buff_group")},onEnable:function(){1!=this.enemyType&&(this.getBulletCb=function(e){this.enemyBulletGroup.enemyOpenFire(this.node)}.bind(this),this.schedule(this.getBulletCb,this.enemyBulletFreq))},init:function(){"enemy"!=this.node.group&&(this.node.group="enemy"),this.hP!=this.initHP&&(this.hP=this.initHP),this.texturePic.active=!0,this.nodeCollision.group="enemy",this.ptcSys1&&this.ptcSys2&&(this.ptcSys1.resetSystem(),this.ptcSys2.resetSystem())},update:function(e){if(this.enemyGroup.curState==o.commonInfo.gameState.start&&0!=this.hP){var t=this.node.x;(t+=e*this.xSpeed)<=-(this.node.parent.width-this.node.width)/2?(t=(this.node.parent.width-this.node.width)/2,this.xSpeed=-this.xSpeed):t>=(this.node.parent.width-this.node.width)/2?(t=(this.node.parent.width-this.node.width)/2,this.xSpeed=-this.xSpeed):this.node.x=t;var i=this.enemyGroup.getScore();1==this.enemyType?this.node.y+=i<=5e5?e*this.ySpeed:i>5e5&&i<=1e6?e*this.ySpeed-.5:i>1e6&&i<=2e6?e*this.ySpeed-1:i>2e6&&i<=3e6?e*this.ySpeed-1.5:i>3e6&&i<=4e6?e*this.ySpeed-2:e*this.ySpeed-2.5:this.node.y+=e*this.ySpeed,this.node.y<-this.node.parent.height/2-this.node.height/2&&(this.enemyGroup.enemyDied(this.node,0),1!=this.enemyType&&this.unschedule(this.getBulletCb))}},enemyOver:function(e){var t=0,i=this.node.getComponent(cc.Animation);"isHero"!=e&&(t=this.score),1!=this.enemyType&&this.unschedule(this.getBulletCb),this.texturePic.active=!1,this.buffGroup.createHeroBuff(this.node),this.ptcSys1&&this.ptcSys2&&(this.ptcSys1.stopSystem(),this.ptcSys2.stopSystem()),i.play("blow_up"),i.on("finished",function(){this.node.getComponent(cc.Sprite).spriteFrame=null,this.node.width=this.initSize,this.node.height=this.initSize,this.enemyGroup.enemyDied(this.node,t)},this)}}),cc._RF.pop()},{globals:"globals"}],fb_game:[function(e,t,i){"use strict";cc._RF.push(t,"8073f6ww+JGVKIA/j+/4zuG","fb_game");var o=e("pipe_manager"),s=e("bird"),n=e("../utils.js");cc.Class({extends:cc.Component,properties:{goldScore:20,silverScore:10,pipeManager:o,bird:s,scoreLabel:cc.Label,maskLayer:{default:null,type:cc.Node},ground:{default:null,type:cc.Node},readyMenu:{default:null,type:cc.Node},gameOverMenu:{default:null,type:cc.Node}},onLoad:function(){this.score=0,this.scoreLabel.string=this.score,this.bird.init(this),this.enableInput(!0),this.revealScene()},revealScene:function(){this.maskLayer.active=!0,this.maskLayer.color=cc.Color.BLACK,this.maskLayer.runAction(cc.fadeOut(.3))},restart:function(){this.maskLayer.color=cc.Color.BLACK,this.maskLayer.runAction(cc.sequence(cc.fadeIn(.3),cc.callFunc(function(){cc.director.loadScene("bird_game")},this)))},gameStart:function(){this.hideReadyMenu(),this.pipeManager.startSpawn(),this.bird.startFly()},gameOver:function(){this.pipeManager.reset(),this.ground.getComponent("scroller").stopScroll(),this.enableInput(!1),this.blinkOnce(),this.showGameOverMenu()},backBegainPage:function(e){cc.director.loadScene("flappy_bird")},gainScore:function(){this.score++,this.scoreLabel.string=this.score},hideReadyMenu:function(){var e=this;this.scoreLabel.node.runAction(cc.fadeIn(.3)),this.readyMenu.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){e.readyMenu.active=!1},this)))},blinkOnce:function(){this.maskLayer.color=cc.Color.WHITE,this.maskLayer.runAction(cc.sequence(cc.fadeTo(.1,200),cc.fadeOut(.1)))},showGameOverMenu:function(){var e=this;this.scoreLabel.node.runAction(cc.sequence(cc.fadeOut(.3),cc.callFunc(function(){e.scoreLabel.node.active=!1},this)));var t=this.gameOverMenu.getChildByName("gameOverLabel"),i=this.gameOverMenu.getChildByName("resultBoard"),o=this.gameOverMenu.getChildByName("startBtn"),s=this.gameOverMenu.getChildByName("backbtn"),c=i.getChildByName("currentScore"),a=i.getChildByName("bestScore"),r=i.getChildByName("medal"),h=n.GD.userGameInfo.fbBestScore||0;this.score>h&&(h=this.score,n.GD.updateGameScore({fbBestScore:h},function(){n.GD.setUserGameInfo("fbBestScore",h),console.log("\u4fdd\u5b58\u6210\u529f")})),c.getComponent(cc.Label).string=this.score,a.getComponent(cc.Label).string=h;cc.loader.loadRes("texture/res_bundle",cc.SpriteAtlas,function(t,i){e.score>=e.goldScore?r.getComponent(cc.Sprite).spriteFrame=i._spriteFrames.medal_gold:e.score>=e.silverScore?r.getComponent(cc.Sprite).spriteFrame=i._spriteFrames.medal_silver:r.getComponent(cc.Sprite).spriteFrame=null});var l=function(t,i,n){o.active=!0,s.active=!0,t.runAction(cc.sequence(i,cc.callFunc(function(){n&&n()},e)))};this.gameOverMenu.active=!0;this.scheduleOnce(function(){return l(t,cc.spawn(cc.fadeIn(.2),cc.sequence(cc.moveBy(.2,cc.p(0,10)),cc.moveBy(.5,cc.p(0,-10)))),function(){return l(i,cc.moveTo(.5,cc.p(i.x,-150)).easing(cc.easeCubicActionOut()),function(){return l(o,cc.fadeIn(.5))})})},.55)},startGameOrJumpBird:function(){this.bird.state===s.State.Ready?this.gameStart():this.bird.rise()},enableInput:function(e){e?this.node.on(cc.Node.EventType.TOUCH_START,this.startGameOrJumpBird,this):this.node.off(cc.Node.EventType.TOUCH_START,this.startGameOrJumpBird,this)}}),cc._RF.pop()},{"../utils.js":"utils",bird:"bird",pipe_manager:"pipe_manager"}],firework_body:[function(e,t,i){"use strict";cc._RF.push(t,"12823llfEVLFo3qcYFzIVwH","firework_body"),cc.Class({extends:cc.Component,properties:{speed:2,acceleration:1.03,targetRadius:1,friction:.95,gravity:-1.3},onLoad:function(){this.parent=this.node.parent.getComponent("firework_init_js"),this.canvasCtx=this.node.getComponent(cc.Graphics),this.width=this.node.width,this.height=this.node.height,this.x=this.sx=this.width/2,this.y=this.sy=0,this.tx=this.parent.finger.down?this.parent.finger.x:this.random(.05*this.width,.95*this.width),this.ty=this.parent.finger.down?this.parent.finger.y:this.random(.5*this.height,.9*this.height),this.fireworksBodycolorRandom=this.colorRandom(),this.distanceToTarget=this.calculateDistance(this.x,this.y,this.tx,this.ty),this.distanceTraveled=0,this.coordinates=[];for(var e=0;e<3;e++)this.coordinates.push([this.x,this.y]);this.angle=Math.atan2(this.ty-this.y,this.tx-this.x),this.targetDirection=!0,this.reachTarget=!1,this.particles=[]},fireworksBodyUpdate:function(){this.coordinates.pop(),this.coordinates.unshift([this.x,this.y]),this.targetDirection?this.targetRadius>1?this.targetRadius-=.15:this.targetDirection=!1:this.targetRadius<8?this.targetRadius+=.15:this.targetDirection=!0,this.speed*=this.acceleration;var e=Math.cos(this.angle)*this.speed,t=Math.sin(this.angle)*this.speed;this.distanceTraveled=this.calculateDistance(this.sx,this.sy,this.x+e,this.y+t),this.distanceTraveled>=this.distanceToTarget?(this.createParticles(this.tx,this.ty),this.reachTarget=!0):(this.x+=e,this.y+=t)},fireworksBodyDraw:function(e){var t=this.coordinates[this.coordinates.length-1],i=new cc.Color({r:this.fireworksBodycolorRandom.r,g:this.fireworksBodycolorRandom.g,b:this.fireworksBodycolorRandom.b,a:255});e.clear(),e.moveTo(t[0],t[1]),e.lineTo(this.x,this.y),e.strokeColor=i,e.arc(this.tx,this.ty,this.targetRadius,0,2*Math.PI),e.stroke()},createParticles:function(e,t){for(var i=Math.round(this.random(this.parent.particleMinNum,this.parent.particleMaxNum));i--;){for(var o=[],s=0;s<5;s++)o.push([e,t]);this.particles.push({x:e,y:t,decay:this.random(3,15),coordinates:o,angle:this.random(0,2*Math.PI),speed:this.random(1,10),alpha:255})}},particleUpdate:function(e,t,i){if(t.coordinates.pop(),t.coordinates.unshift([t.x,t.y]),t.speed*=this.friction,t.x+=Math.cos(t.angle)*t.speed,t.y+=Math.sin(t.angle)*t.speed+this.gravity,t.alpha-=t.decay,t.alpha<=t.decay)return this.particles.splice(e,1),void(0===this.particles.length&&this.node.destroy());var o=t.coordinates[t.coordinates.length-1],s=this.randomColorInRange(this.fireworksBodycolorRandom,this.parent.range);e==this.particles.length-1&&i.clear(),i.moveTo(o[0],o[1]),i.lineTo(t.x,t.y),i.strokeColor=new cc.Color({r:s.r,g:s.g,b:s.b,a:t.alpha}),i.stroke()},randomColorInRange:function(e,t){return{r:Math.round(this.random(e.r-t,e.r+t)),g:Math.round(this.random(e.g-t,e.g+t)),b:Math.round(this.random(e.b-t,e.b+t))}},calculateDistance:function(e,t,i,o){var s=e-i,n=t-o;return Math.sqrt(Math.pow(s,2)+Math.pow(n,2))},colorRandom:function(){return{r:Math.round(this.random(this.parent.range,255-this.parent.range)),g:Math.round(this.random(this.parent.range,255-this.parent.range)),b:Math.round(this.random(this.parent.range,255-this.parent.range))}},random:function(e,t){return Math.random()*(t-e)+e},update:function(e){if(this.reachTarget)for(var t=this.particles.length;t--;)this.particleUpdate(t,this.particles[t],this.canvasCtx);else this.fireworksBodyDraw(this.canvasCtx),this.fireworksBodyUpdate()}}),cc._RF.pop()},{}],firework_init_js:[function(e,t,i){"use strict";cc._RF.push(t,"8834eKbd5ZIh5BjhCu0aStr","firework_init_js"),cc.Class({extends:cc.Component,properties:{canvas:{default:null,type:cc.Node},fireworksBody:{default:null,type:cc.Prefab}},onLoad:function(){this.finger={down:!1,x:0,y:0},this.range=40,this.particleMinNum=30,this.particleMaxNum=100,this.clickLimiterTotal=10,this.clickLimiterTick=0,this.timerTotal=80,this.timerTick=0,this.handlerEvents(),this.node.width=this.canvas.width,this.node.height=this.canvas.height},back_game_list:function(){cc.director.loadScene("startscene")},handlerEvents:function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_START,function(t){var i=t.getLocation(),o=i.x,s=i.y;e.finger.x=o,e.finger.y=s,e.finger.down=!0},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(t){var i=t.getLocation(),o=i.x,s=i.y;e.finger.x=o,e.finger.y=s},this),this.node.on(cc.Node.EventType.TOUCH_END,function(t){e.finger.down=!1},this)},createFireworksBody:function(){var e=cc.instantiate(this.fireworksBody);e.width=this.node.width,e.height=this.node.height,this.node.addChild(e)},update:function(e){this.timerTick>=this.timerTotal?this.finger.down||(this.createFireworksBody(),this.timerTick=0):this.timerTick++,this.clickLimiterTick>=this.clickLimiterTotal?this.finger.down&&(this.createFireworksBody(),this.clickLimiterTick=0):this.clickLimiterTick++}}),cc._RF.pop()},{}],food:[function(e,t,i){"use strict";cc._RF.push(t,"b65a211UR1BfLsipP6pCQAb","food"),cc.Class({extends:cc.Component,properties:{foodPrefab:{default:null,type:cc.Prefab}},onLoad:function(){this.foodPool=new cc.NodePool;for(var e=0;e<3;++e){var t=cc.instantiate(this.foodPrefab);this.foodPool.put(t)}this.foodInstance=null,this.isOnSnake=!0,this.snake=this.node.getComponent("snake").snakeArray,this.obstacleArr=this.node.getComponent("obstacle").obstacleInstance,this.foodX=0,this.foodY=0,this.foodPosShow()},getNumberInRange:function(e,t){var i=t-e,o=2*Math.random()-1;return Math.round(o*i+e)},foodPosShow:function(){this.isOnSnake=!0;for(var e=void 0,t=void 0;this.isOnSnake;){this.isOnSnake=!1,e=this.getNumberInRange(0,this.node.width/30-1),t=this.getNumberInRange(0,this.node.height/30-1);for(var i=0;i<this.snake.length;i++)if(this.snake[i].x==15*e&&this.snake[i].y==15*t){this.isOnSnake=!0;break}if(!this.isOnSnake)for(var o=0;o<this.obstacleArr.length;o++)if(15*e==this.obstacleArr[o].x&&15*t==this.obstacleArr[o].y){this.isOnSnake=!0;break}(15*e<-this.node.width/2+30||15*e>this.node.width/2-30||15*t<-this.node.height/2+30||15*t>this.node.height/2-30)&&(this.isOnSnake=!0)}this.foodPool.size()>0?this.foodInstance=this.foodPool.get():this.foodInstance=cc.instantiate(this.foodPrefab),this.node.addChild(this.foodInstance),this.foodInstance.setPosition(cc.p(15*e,15*t)),this.foodX=15*e,this.foodY=15*t},releaseFood:function(){this.foodPool.put(this.foodInstance),this.foodInstance=null}}),cc._RF.pop()},{}],fruit_game_start:[function(e,t,i){"use strict";cc._RF.push(t,"3b8a9kQaRJIRrj33JJDuNVM","fruit_game_start"),cc.Class({extends:cc.Component,properties:{knife:{default:null,type:cc.Node},btnBeginCir:{default:null,type:cc.Node},btnQuitCir:{default:null,type:cc.Node}},onLoad:function(){this.knifeMotionS=this.knife.getComponent(cc.MotionStreak)},start:function(){this.knifeMove(),this.circleRotate()},knifeMove:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.startEvent,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.moveEvent,this)},startEvent:function(e){var t=this.node.convertToNodeSpaceAR(new cc.Vec2(e.getLocation()));this.knife.setPosition(t),this.knifeMotionS.reset()},moveEvent:function(e){var t=this.node.convertToNodeSpaceAR(new cc.Vec2(e.getLocation()));this.knife.setPosition(t)},circleRotate:function(){var e=cc.repeatForever(cc.sequence(cc.rotateBy(0,0),cc.rotateBy(7,360))),t=cc.repeatForever(cc.sequence(cc.rotateBy(0,0),cc.rotateBy(7,360)));this.btnBeginCir.runAction(e),this.btnQuitCir.runAction(t)},backList:function(){cc.director.loadScene("startscene")},gameStart:function(){cc.director.loadScene("fruit_ninja_game")}}),cc._RF.pop()},{}],fruit_juice_group:[function(e,t,i){"use strict";cc._RF.push(t,"60f410JsUNGy4tw8ayMkS1r","fruit_juice_group");var o=e("../utils"),s=cc.Class({name:"juiceColor",properties:{code:0,color:cc.Color,opacity:255}});cc.Class({extends:cc.Component,properties:{juiceColor:{default:[],type:s},juicePfb:{default:null,type:cc.Prefab}},onLoad:function(){var e={name:"fruitJuice",prefab:this.juicePfb,initPoolCount:20};this.poolName="fruitJuicePool",o.initObjPool(this,e)},createjuiceBg:function(e,t){var i=this.juiceColor.filter(function(e){return e.code==t})[0],s=i.color,n=o.random(0,359),c=i.opacity,a=o.genNewNode(this[this.poolName],this.juicePfb,this.node);a.setPosition(e),a.getComponent("fruit_juice").init(n,s,c)},backNode:function(e){o.backObjPool(this,this.poolName,e)}}),cc._RF.pop()},{"../utils":"utils"}],fruit_juice:[function(e,t,i){"use strict";cc._RF.push(t,"c8b30gJzGlLoJWZBCOCpXKG","fruit_juice"),cc.Class({extends:cc.Component,properties:{juiceSprite:{default:null,type:cc.Node}},onLoad:function(){this.parentObj=this.node.parent.getComponent("fruit_juice_group")},init:function(e,t,i){var o=this;this.node.rotation=e,this.juiceSprite.color=t,this.juiceSprite.opacity=i,this.juiceSprite.runAction(cc.sequence(cc.fadeOut(1.5),cc.callFunc(function(){o.parentObj.backNode(o.node,o.colorType)},this)))}}),cc._RF.pop()},{}],fruit_ninja_fruit:[function(e,t,i){"use strict";cc._RF.push(t,"b27f0f8tplBLJU9TzXaiOUK","fruit_ninja_fruit");var o=e("../utils");cc.Class({extends:cc.Component,properties:{complFruit:{default:null,type:cc.Node},splitAni:{default:null,type:cc.Node},type:"fruit",forceHorzMin:0,forceHorzMax:1e3,forceMin:3e4,forceMax:35e3,colorType:1},onLoad:function(){this.poolName="",this.gameObj=cc.find("/Canvas/gameContainer").getComponent("fruit_ninja_game"),this.parent=this.node.parent.getComponent("fruit_ninja_group"),this.fruitJuiceGroup=cc.find("/Canvas/gameContainer/fruitJuice").getComponent("fruit_juice_group"),"fruit"==this.type&&(this.ani=this.splitAni.getComponent("cc.Animation"))},init:function(e,t){this.poolName=e,this.score=t,this.isCut=!1,"fruit"==this.type&&(this.complFruit.active=!0,this.splitAni.active=!1,this.recoveryAniFirstFps());var i=this.node.getComponent(cc.RigidBody),s=Math.floor(o.random(this.forceMin,this.forceMax)),n=Math.floor(o.random(this.forceHorzMin,this.forceHorzMax));i.angularVelocity=o.random(-1,1)>0?100:-100,i.applyForceToCenter(cc.p(this.node.x>0?-n:n,s),!0)},onCollisionEnter:function(e,t){50==e.tag&&(this.isCut||("fruit"==this.type?(this.fruitJuiceGroup.createjuiceBg(this.node.getPosition(),this.colorType),this.playSplitAni(),this.gameObj.updateScore(1,this.score)):this.parent.cutBombRemoveAllChildren()),this.isCut=!0),100==e.tag&&(this.backThisNode(),this.parent.checkRemain())},playSplitAni:function(){this.complFruit.active=!1,this.splitAni.active=!0,this.ani.play()},recoveryAniFirstFps:function(){for(var e=this.ani.getClips()[0].name,t=this.ani.getAnimationState(e),i=t.curves,o=t.getWrappedInfo(.01),s=0,n=i.length;s<n;s++){i[s].sample(o.time,o.ratio,this)}},backThisNode:function(e){e||"fruit"!=this.type||this.isCut||this.gameObj.updateScore(0,this.score),o.backObjPool(this.parent,this.poolName,this.node)}}),cc._RF.pop()},{"../utils":"utils"}],fruit_ninja_game:[function(e,t,i){"use strict";cc._RF.push(t,"fc73aaZdOpM2YMrzlo6Gi5Y","fruit_ninja_game");var o=e("../utils.js"),s=cc.Class({name:"lifeG",properties:{index:0,lifeConsume:{default:null,type:cc.Node}}});cc.Class({extends:cc.Component,properties:{knife:{default:null,type:cc.Node},scoreLabel:{default:null,type:cc.Label},lifeG:{default:[],type:s},fruitGroup:{default:null,type:e("fruit_ninja_group")},gameOverMask:{default:null,type:cc.Node},bestScoreLabel:{default:null,type:cc.Label}},onLoad:function(){cc.director.getCollisionManager().enabled=!0;var e=cc.director.getPhysicsManager();e.enabled=!0,e.debugDrawFlags=0,this.knifeMotionS=this.knife.getComponent(cc.MotionStreak)},start:function(){this.knifeMove(),this.init()},init:function(){this.gameOver=!1,this.score=0,this.bestScore=o.GD.userGameInfo.fruitNinjaBestScore||0,this.life=0,this.lifeG.forEach(function(e){e.lifeConsume.active=!1}),this.upDateUi(),this.fruitGroup.createFruitList()},knifeMove:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.startEvent,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.moveEvent,this),this.node.on(cc.Node.EventType.TOUCH_END,this.endEvent,this)},startEvent:function(e){var t=this.node.convertToNodeSpaceAR(new cc.Vec2(e.getLocation()));this.knife.setPosition(t),this.knife.group="knife",this.knifeMotionS.reset()},moveEvent:function(e){var t=this.node.convertToNodeSpaceAR(new cc.Vec2(e.getLocation()));this.knife.setPosition(t)},endEvent:function(e){this.knife.group="default"},updateScore:function(e,t){this.gameOver||(e?this.score+=t:(0==this.score&&this.lifeConsume(),this.score=this.score<2*t?0:this.score-2*t),this.upDateUi())},lifeConsume:function(){this.life++,3==this.life&&this.gameOverHandle()},upDateUi:function(){this.scoreLabel.string=this.score;for(var e=0;e<this.life;e++)this.lifeG[e].lifeConsume.active=!0},gameOverHandle:function(){var e=this;this.gameOver=!0,this.knife.group="default",this.score>this.bestScore&&(this.bestScore=this.score,this.bestScoreLabel.string="Best score: "+this.bestScore,this.updateBestScore()),this.scheduleOnce(function(){e.showTheGameOverMask(!0)},.5,this)},backStart:function(){cc.director.loadScene("fruit_ninja_start")},restartGame:function(){this.showTheGameOverMask(!1),this.init()},showTheGameOverMask:function(e){var t=this;e?(this.gameOverMask.active=!0,this.gameOverMask.opacity=0,this.gameOverMask.runAction(cc.sequence(cc.scaleTo(0,.9,.9),cc.spawn(cc.scaleTo(.4,1,1),cc.fadeIn(.4))))):this.gameOverMask.runAction(cc.sequence(cc.fadeOut(.4),cc.callFunc(function(){t.gameOverMask.active=!1},this)))},updateBestScore:function(){var e=this;o.GD.updateGameScore({fruitNinjaBestScore:e.bestScore},function(){o.GD.setUserGameInfo("fruitNinjaBestScore",e.bestScore),console.log("\u4fdd\u5b58\u6210\u529f")})}}),cc._RF.pop()},{"../utils.js":"utils",fruit_ninja_group:"fruit_ninja_group"}],fruit_ninja_group:[function(e,t,i){"use strict";cc._RF.push(t,"85e0bx3wFxCTIjVuUOkg08n","fruit_ninja_group");var o=e("../utils"),s=cc.Class({name:"fruitG",properties:{name:"",initPoolCount:10,score:0,type:"fruit",prefab:{default:null,type:cc.Prefab}}});cc.Class({extends:cc.Component,properties:{maxLength:5,flashNode:{default:null,type:cc.Node},fruitG:{default:[],type:s}},onLoad:function(){this.gameObj=this.node.parent.getComponent("fruit_ninja_game"),this.noBombArr=this.fruitG.filter(function(e){return"fruit"==e.type}),o.batchInitObjPool(this,this.fruitG)},createFruitList:function(){for(var e=this.fruitG,t=Math.floor(o.random(1,this.maxLength+.4)),i=0;i<t;i++){var s,n;n=(s=e[Math.floor(Math.floor(o.random(0,e.length-.1)))]).name+"Pool";var c=o.genNewNode(this[n],s.prefab,this.node);c.setPosition(cc.p(o.random(-this.node.width/2+c.width/2,this.node.width/2-c.width/2),-(this.node.height/2-c.height/2))),c.getComponent("fruit_ninja_fruit").init(n,s.score),"bomb"==s.type&&(e=this.noBombArr)}},checkRemain:function(){var e=this;this.gameObj.gameOver||0==this.node.children.length&&this.scheduleOnce(function(){e.createFruitList()},.5,this)},cutBombRemoveAllChildren:function(){var e=this;this.flashScreen();for(var t=this.node.children.map(function(e){return e.getComponent("fruit_ninja_fruit")}),i=0;i<t.length;i++)t[i].backThisNode(!0);this.gameObj.lifeConsume(),this.gameObj.upDateUi(),this.gameObj.gameOver||this.scheduleOnce(function(){e.createFruitList()},.5,this)},flashScreen:function(){var e=this;this.flashNode.active=!0,this.flashNode.opacity=230;var t=cc.sequence(cc.fadeOut(.8),cc.callFunc(function(){e.flashNode.active=!1},this));this.flashNode.runAction(t)}}),cc._RF.pop()},{"../utils":"utils"}],ftc_start:[function(e,t,i){"use strict";cc._RF.push(t,"276f4sGObpMdYwYbM0ENhmM","ftc_start"),cc.Class({extends:cc.Component,properties:function(){return{gameMask:{default:null,type:cc.Node},circleGroup:{default:null,type:e("circle_group")}}},onLoad:function(){},startGame:function(){this.showGameMask(!1),this.circleGroup.startCreateCircles()},showGameMask:function(e){this.gameMask.active=e;var t=void 0;e?(this.gameMask.opacity=0,t=cc.fadeIn(.3)):t=cc.fadeOut(.3),this.gameMask.runAction(t)},tapCloseBtnToQuitThisGame:function(){this.circleGroup.handleGameOver()},backList:function(){cc.director.loadScene("startscene")}}),cc._RF.pop()},{circle_group:"circle_group"}],game_global:[function(e,t,i){"use strict";cc._RF.push(t,"b4e1dbvghZDWYKVVQDCTOyc","game_global"),t.exports={gameMode:"free",freeBestScore:0,gameLevel:1,gameLevelData:[]},cc._RF.pop()},{}],game_info:[function(e,t,i){"use strict";cc._RF.push(t,"30e8fslMy9BWZzIAtJXBIZD","game_info");var o=e("../utils.js");cc.Class({extends:cc.Component,properties:{canvas:{default:null,type:cc.Node},btn1:{default:null,type:cc.Node},scoreLabel:{default:null,type:cc.Label},bestScore:{default:null,type:cc.Label}},onLoad:function(){var e=this,t=o.GD.userGameInfo.snakeBestScore||0,i=this.canvas.getComponent("snake_game").score;this.scoreLabel.string="Score:"+i.toString(),i>t&&(t=i,o.GD.updateGameScore({snakeBestScore:t},function(){o.GD.setUserGameInfo("snakeBestScore",t),console.log("\u4fdd\u5b58\u6210\u529f")})),this.bestScore.string="best:"+t,this.btn1.on(cc.Node.EventType.TOUCH_START,function(t){e.node.runAction(cc.sequence(cc.fadeOut(.2),cc.callFunc(function(){e.node.active=!1,cc.director.loadScene("snake")},e)))},this)},backToList:function(){cc.director.loadScene("startscene")}}),cc._RF.pop()},{"../utils.js":"utils"}],game_start_btn:[function(e,t,i){"use strict";cc._RF.push(t,"95c8eVM+91PqZe8TEbXZnz4","game_start_btn"),cc.Class({extends:cc.Component,properties:{label:{default:null,type:cc.Label}},loadGame:function(){this.url&&cc.director.loadScene(this.url)},updateItem:function(e,t,i,o){this.index=e,this.node.y=t,this.label.string=i,this.url=o}}),cc._RF.pop()},{}],game_user_js:[function(e,t,i){"use strict";cc._RF.push(t,"35fe2mm+OVPpramB1QEvyTF","game_user_js");var o=e("./utils.js");cc.Class({extends:cc.Component,properties:{},onLoad:function(){cc.game.addPersistRootNode(this.node),cc.sys.platform===cc.sys.WECHAT_GAME&&(wx.cloud.init(),this.db=wx.cloud.database(),this.openid="",this.wxEnv=!0),this.userGameInfo={snakeBestScore:0,fbBestScore:0,tzfeBestScore:0,tzfeWinNum:0,needleFreeModeScore:0,needleLevelModeLevels:1,tetrisBestScore:0,aircraftWarBestScore:0,donttWhiteBlockScore:0,ftcBestScore:0,ftcBestCombo:0,fruitNinjaBestScore:0,skyscraperBestScore:0},this.needleLevelData=[{level:1,speed:12,needlesNum:6,generatedNeedlesAngle:[90]},{level:2,speed:12,needlesNum:10,generatedNeedlesAngle:[90,180,270]},{level:3,speed:10,needlesNum:10,generatedNeedlesAngle:[0,60,120,180,240,300]},{level:4,speed:10,needlesNum:15,generatedNeedlesAngle:[50,100,130,200,230,300]},{level:5,speed:8,needlesNum:15,generatedNeedlesAngle:[20,40,100,120,140,200,220,300]},{level:6,speed:6,needlesNum:17,generatedNeedlesAngle:[80,160,240,320]},{level:7,speed:5,needlesNum:19,generatedNeedlesAngle:[50,90,140,200,270]}]},start:function(){this.wxEnv?(this.login(),this.getNeedlesLevelData()):this.setLocalStorageForGameInfo(),o.GD=this},setLocalStorageForGameInfo:function(e){if(localStorage){var t=localStorage.getItem("userGameInfo");if(e){var i=JSON.parse(t);Object.keys(e).forEach(function(t){i[t]=e[t]}),localStorage.setItem("userGameInfo",JSON.stringify(i))}else t||localStorage.setItem("userGameInfo",JSON.stringify(this.userGameInfo))}},showWxLoading:function(e){this.wxEnv&&(e?wx.showLoading({title:"\u8bf7\u7a0d\u5019...",mask:!0}):wx.hideLoading())},setUserGameInfo:function(e,t){this.userGameInfo[e]=t},collectionDoc:function(e){this.wxEnv?this.db.collection(e.collectionName).doc(e.id).get({success:function(t){e.success(t)},fail:function(t){e.fail&&e.fail(t)}}):e.success()},collectionWhere:function(e){this.wxEnv?this.db.collection(e.collectionName).where(e.whereCondi).get({success:function(t){e.success(t)},fail:function(t){e.fail&&e.fail(t)}}):e.success()},collectionAdd:function(e){this.wxEnv?this.db.collection(e.collectionName).add({data:e.data,success:function(t){e.success(t)},fail:function(t){e.fail&&e.fail(t)}}):e.success()},collectionUpdate:function(e){var t=this;if(t.wxEnv){var i={};Object.keys(e.data).forEach(function(t){i[t]=e.data[t]}),i.updateTime=t.db.serverDate(),t.collectionWhere({collectionName:e.collectionName,whereCondi:e.whereCondi,success:function(o){o.data.length?t.db.collection(e.collectionName).doc(o.data[0]._id).update({data:i,success:function(t){e.success(t)},fail:function(t){e.fail&&e.fail(t)}}):console.log("\u7528\u6237\u6e38\u620f\u4fe1\u606f\u4e0d\u5b58\u5728")},fail:function(t){e.fail&&e.fail(t)}})}else this.setLocalStorageForGameInfo(e.data),e.success()},login:function(){var e=this;e.showWxLoading(!0),wx.cloud.callFunction({name:"login",success:function(t){e.openid=t.result.openid,e.checkRecordFromDatabase()},fail:function(t){e.showWxLoading(!1),console.log(t)}})},checkRecordFromDatabase:function(){var e=this;e.collectionWhere({collectionName:"userGameInfo",whereCondi:{_openid:e.openid},success:function(t){if(e.showWxLoading(!1),0==t.data.length){var i={};Object.keys(e.userGameInfo).forEach(function(t){i[t]=e.userGameInfo[t]}),i.createTime=e.db.serverDate(),i.updateTime=e.db.serverDate(),e.collectionAdd({collectionName:"userGameInfo",data:i,success:function(e){console.log(e)},fail:function(e){console.log(e)}})}else e.userGameInfo=t.data[0]},fail:function(t){console.log(t),e.showWxLoading(!1)}})},getNeedlesLevelData:function(){var e=this;wx.cloud.callFunction({name:"getNeedleLevel",success:function(t){e.needleLevelData=t.result.data},fail:function(e){console.log(e)}})},getIndexNoticePic:function(e){var t=this;t.collectionDoc({collectionName:"gameConfig",id:"W9J4AAIrVDZJFtdW",success:function(i){if(i){var o=[];o.push(i.data.indexBottomBanner),wx.cloud.getTempFileURL({fileList:o,success:function(t){e&&e(t)},fail:function(e){t.showWxLoading(!1),console.log(e)}})}else e&&e()},fail:function(e){t.showWxLoading(!1),console.log(e)}})},getAircaftWarBg:function(e){var t=this;t.collectionDoc({collectionName:"gameConfig",id:"XDWYPuSiwXKAQnli",success:function(i){if(i){var o=[];o.push(i.data.loopbg),wx.cloud.getTempFileURL({fileList:o,success:function(t){e&&e(t)},fail:function(e){t.showWxLoading(!1),console.log(e)}})}else e&&e()},fail:function(e){t.showWxLoading(!1),console.log(e)}})},updateGameScore:function(e,t){this.collectionUpdate({collectionName:"userGameInfo",whereCondi:{_openid:this.openid},data:e,success:function(e){t&&t(e)},fail:function(e){console.log(e)}})}}),cc._RF.pop()},{"./utils.js":"utils"}],gamescene_bg:[function(e,t,i){"use strict";cc._RF.push(t,"dd573wJPI1ByouW98ka9izX","gamescene_bg");var o=e("globals");cc.Class({extends:cc.Component,properties:{loopBg1:{default:null,type:cc.Node}},start:function(){o.loopBg&&(this.loopBg1.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o.loopBg))}}),cc._RF.pop()},{globals:"globals"}],globals:[function(e,t,i){"use strict";cc._RF.push(t,"26a87D828tBa4mJGBN0GZgQ","globals"),t.exports={common:null,commonInfo:null,loopBg:""},cc._RF.pop()},{}],headColliderListener:[function(e,t,i){"use strict";cc._RF.push(t,"8717dbyOB5KjJwuNzAHNLMC","headColliderListener"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.game=cc.find("Canvas").getComponent("snake_game")},onCollisionEnter:function(e,t){this.game.gameOver=!0}}),cc._RF.pop()},{}],hero:[function(e,t,i){"use strict";cc._RF.push(t,"3f0ccHUefxOLK9+K5/zp2v4","hero");var o=e("globals");cc.Class({extends:cc.Component,properties:{moveRatio:.8,heroInitHp:10,heroHp:10,progressW:60,hpProgressBar:{default:null,type:cc.Node},main:{default:null,type:e("main")},bulletGroup:{default:null,type:e("bullet_group")},heroDropHpBg:{default:null,type:cc.Node}},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.curState=o.commonInfo.gameState.none,this.currX=0,this.currY=0,this.onDrag(),this.node.x=0,this.node.y=-this.node.parent.height/2+this.node.height/2+12,this.setHeroHpPregress()},onDrag:function(){this.node.parent.on(cc.Node.EventType.TOUCH_START,this.dragStart,this),this.node.parent.on(cc.Node.EventType.TOUCH_MOVE,this.dragMove,this)},offDrag:function(){this.node.parent.off(cc.Node.EventType.TOUCH_START,this.dragStart,this),this.node.parent.off(cc.Node.EventType.TOUCH_MOVE,this.dragMove,this)},dragStart:function(e){var t=e.getLocation();this.currX=t.x,this.currY=t.y},dragMove:function(e){var t=e.getLocation(),i={x:this.node.x,y:this.node.y},o=-this.node.parent.width/2+this.node.width/2,s=-o,n=-this.node.parent.height/2+this.node.height/2,c=-n;i.x+=(t.x-this.currX)*this.moveRatio,i.y+=(t.y-this.currY)*this.moveRatio,this.currX=t.x,this.currY=t.y,i.x<o&&(i.x=o),i.x>s&&(i.x=s),i.y<n&&(i.y=n),i.y>c&&(i.y=c),this.node.setPosition(i)},setHeroHpPregress:function(){this.heroHp>0?this.hpProgressBar.width=this.heroHp/this.heroInitHp*this.progressW:this.hpProgressBar.width=0},heroHitByEnemyShowBlood:function(){var e=this;this.heroDropHpBg.active=!0,this.heroDropHpBg.opacity=0;var t=cc.sequence(cc.fadeTo(.2,100),cc.fadeTo(.2,0),cc.callFunc(function(){e.heroDropHpBg.active=!1},this));this.heroDropHpBg.runAction(t)},onCollisionEnter:function(e,t){if("buff"==e.node.group)"buffBullet"==e.node.name?this.bulletGroup.changeBullet(e.node.name):"buffBomb"==e.node.name?this.main.getBuffBomb():"buffHeart"==e.node.name&&(this.heroInitHp-this.heroHp>=5?this.heroHp=this.heroHp+5:this.heroHp=this.heroInitHp);else if("enemy"==e.node.group){var i=e.node.parent.getComponent("enemy");this.heroHp-=i.heroDropHp,e.node.group="default",this.heroHp>0&&this.heroHitByEnemyShowBlood()}else{if("enemyBullet"!=e.node.group)return!1;var o=e.node.getComponent("enemy_bullet");this.heroHp-=o.hpDrop,this.heroHp>0&&this.heroHitByEnemyShowBlood()}if(this.setHeroHpPregress(),this.heroHp<=0){var s=this.node.getComponent(cc.Animation);s.play("blow_up"),s.on("finished",this.onFinished,this),this.main.gameOver()}},onFinished:function(e){this.node.destroy()}}),cc._RF.pop()},{bullet_group:"bullet_group",globals:"globals",main:"main"}],main:[function(e,t,i){"use strict";cc._RF.push(t,"6afa0phF7dPka/zlZtFFHow","main");var o=e("globals"),s=e("../utils.js");cc.Class({extends:cc.Component,properties:function(){return{pause:{default:null,type:cc.Button},btnSprite:{default:[],type:cc.SpriteFrame},bomb:{default:null,type:cc.Node},hero:{default:null,type:e("hero")},enemyGroup:{default:null,type:e("enemy_group")},enemyBulletGroup:{default:null,type:e("enemy_bullet_group")},buffGroup:{default:null,type:e("buff_group")},bulletGroup:{default:null,type:e("bullet_group")},scoreDisplay:{default:null,type:cc.Label},bombNoDisplay:{default:null,type:cc.Label},gameOverMask:{default:null,type:cc.Node},maskBestScore:{default:null,type:cc.Label},maskCurrScore:{default:null,type:cc.Label},pauseBackBtn:{default:null,type:cc.Node}}},onLoad:function(){this.score=0,this.bombNo=0,this.isGameOver=!1,this.scoreDisplay.string=this.score,this.bombNoDisplay.string=this.bombNo,this.curState=o.commonInfo.gameState.start,this.bestScore=s.GD.userGameInfo.aircraftWarBestScore||0,this.maskBestScore.string="Best Score: "+this.bestScore,this.bulletGroup.startAction(),this.enemyGroup.startAction(),this.bomb.on(cc.Node.EventType.TOUCH_START,this.bombOnclick,this)},bombOnclick:function(){if(!this.isGameOver){var e=this.bombNoDisplay,t=parseInt(e.string);t>0&&(e.string=t-1,this.removeAllEnemy())}},pauseClick:function(){this.isGameOver||(this.curState==o.commonInfo.gameState.pause?(this.resumeAction(),this.curState=o.commonInfo.gameState.start,this.showBackBtnPausing(!1)):this.curState==o.commonInfo.gameState.start&&(this.pauseAction(),this.curState=o.commonInfo.gameState.pause,this.showBackBtnPausing(!0)))},showBackBtnPausing:function(e){var t=void 0;this.pauseBackBtn.active=e,e&&(this.pauseBackBtn.opacity=0,t=cc.sequence(cc.scaleTo(0,.95,.95),cc.spawn(cc.fadeIn(.2),cc.scaleTo(.2,1,1))),this.pauseBackBtn.runAction(t))},resumeAction:function(){this.enemyGroup.resumeAction(),this.enemyBulletGroup.resumeAction(),this.bulletGroup.resumeAction(),this.buffGroup.resumeAction(),this.hero.onDrag(),this.pause.getComponent(cc.Sprite).spriteFrame=this.btnSprite[0]},pauseAction:function(){this.curState=o.commonInfo.gameState.pause,this.enemyGroup.pauseAction(),this.enemyBulletGroup.pauseAction(),this.bulletGroup.pauseAction(),this.buffGroup.pauseAction(),this.hero.offDrag(),this.pause.getComponent(cc.Sprite).spriteFrame=this.btnSprite[1]},gainScore:function(e){this.isGameOver||(this.score+=e,this.scoreDisplay.string=this.score.toString())},getScore:function(){return parseInt(this.scoreDisplay.string)},removeAllEnemy:function(){for(var e=this.enemyGroup.node.children,t=0;t<e.length;t++){var i=e[t].getComponent("enemy");i.hP=0,i.enemyOver()}for(var o=this.enemyBulletGroup.node.children,s=0;s<o.length;s++)this.enemyBulletGroup.bulletDied(o[s])},getBuffBomb:function(){parseInt(this.bombNoDisplay.string)<3&&(this.bombNoDisplay.string+=1)},gameOver:function(){this.isGameOver=!0,this.pauseAction(),this.gameOverMaskVis()},gameOverMaskVis:function(){this.gameOverMask.active=!0,this.gameOverMask.opacity=0,this.gameOverMask.runAction(cc.fadeIn(.3)),this.score>this.bestScore&&(this.bestScore=this.score,this.requestDbAircraftWarScore()),this.maskCurrScore.string="Current Score: "+this.score,this.maskBestScore.string="Best Score: "+this.bestScore},playAgain:function(){cc.director.loadScene("aircraft_war_game")},backStartScene:function(){cc.director.loadScene("aircraft_war_start")},requestDbAircraftWarScore:function(){var e=this;s.GD.updateGameScore({aircraftWarBestScore:e.bestScore},function(){s.GD.setUserGameInfo("aircraftWarBestScore",e.bestScore),console.log("\u4fdd\u5b58\u6210\u529f")})}}),cc._RF.pop()},{"../utils.js":"utils",buff_group:"buff_group",bullet_group:"bullet_group",enemy_bullet_group:"enemy_bullet_group",enemy_group:"enemy_group",globals:"globals",hero:"hero"}],needleCollider:[function(e,t,i){"use strict";cc._RF.push(t,"a2e3eydC/lMu4KRrjIdcxPG","needleCollider"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){cc.director.getCollisionManager().enabled=!0},onCollisionEnter:function(e,t){t.node.parent.parent.parent.getComponent("needles_main").gameOver()}}),cc._RF.pop()},{}],needles_draw_circle:[function(e,t,i){"use strict";cc._RF.push(t,"f61aaduPWdFQ4opZlD0/583","needles_draw_circle"),cc.Class({extends:cc.Component,properties:{r:0},onLoad:function(){this.ctx=this.node.getComponent(cc.Graphics)},start:function(){this.ctx.circle(this.r,this.r,this.r),this.ctx.fill()}}),cc._RF.pop()},{}],needles_init:[function(e,t,i){"use strict";cc._RF.push(t,"9b71d3kBf9IQKtD0FfvVopm","needles_init");var o=e("./game_global.js"),s=e("../utils.js");cc.Class({extends:cc.Component,properties:{levelModeMask:{default:null,type:cc.Node},levelBtnLevelTxt:{default:null,type:cc.Label}},onLoad:function(){o.freeBestScore=s.GD.userGameInfo.needleFreeModeScore||0,o.gameLevel=s.GD.userGameInfo.needleLevelModeLevels||1,o.gameLevelData=s.GD.needleLevelData,this.levelBtnLevelTxt.string="level "+o.gameLevel+" play"},levelModeMaskOpen:function(){this.levelModeMask.active=!0,this.levelModeMask.opacity=0,this.levelModeMask.runAction(cc.sequence(cc.scaleTo(0,.9,.9),cc.spawn(cc.scaleTo(.2,1,1),cc.fadeIn(.3))))},levelModeMaskClose:function(){var e=this;this.levelModeMask.runAction(cc.sequence(cc.spawn(cc.fadeOut(.2),cc.scaleTo(.2,.9,.9)),cc.callFunc(function(){e.levelModeMask.active=!1},this)))},freeMode:function(){o.mode="free",cc.director.loadScene("game_needles")},levelModePlay:function(){o.mode="level",cc.director.loadScene("game_needles")},backList:function(){cc.director.loadScene("startscene")}}),cc._RF.pop()},{"../utils.js":"utils","./game_global.js":"game_global"}],needles_main:[function(e,t,i){"use strict";cc._RF.push(t,"904ceXexs9NO5K90wK8ohoB","needles_main");var o=e("./game_global.js"),s=e("../utils.js");cc.Class({extends:cc.Component,properties:{bigCircle:{default:null,type:cc.Node},needlePfb:{default:null,type:cc.Prefab},moveNeedle:{default:null,type:cc.Node},waitContent:{default:null,type:cc.Node},modeTypeTxt:{default:null,type:cc.Node},levelTxt:{default:null,type:cc.Node},gameInfoMask:{default:null,type:cc.Node}},onLoad:function(){this.needlesNum="",this.freeModeCurrNeedle=0,this.freeModeCurrScore=0,this.rotateSpeed=12,this.isGameOver=!1,this.actionInts=null,this.needlesPool=new cc.NodePool;for(var e=0;e<40;++e){var t=cc.instantiate(this.needlePfb);this.needlesPool.put(t)}},LevelSceneInit:function(){if("level"===o.mode){var e=o.gameLevel,t=o.gameLevelData.filter(function(t){return t.level==e});if(t.length>0){for(var i=t[0].generatedNeedlesAngle,s=0;s<i.length;s++){var n=void 0;(n=this.needlesPool.size()>0?this.needlesPool.get():cc.instantiate(this.needlePfb)).rotation=i[s],n.getComponent("draw_needles").speed=t[0].speed,this.bigCircle.addChild(n)}this.actionInts=this.circleRotate(t[0].speed),this.needlesNum=t[0].needlesNum,this.rotateSpeed=t[0].speed}}else this.actionInts=this.circleRotate(4),this.needlesNum=""},createNeedles:function(e){var t=void 0;t=this.needlesPool.size()>0?this.needlesPool.get():cc.instantiate(this.needlePfb);var i=360-this.bigCircle.rotation%360;t.rotation=i;var s=0,n=4;"level"===o.mode?(s=this.needlesNum+1,n=this.rotateSpeed):s=this.freeModeCurrNeedle,t.getChildByName("needleNum").getComponent(cc.Label).string=s,t.getComponent("draw_needles").speed=n,this.bigCircle.addChild(t)},circleRotate:function(e){var t=cc.repeatForever(cc.sequence(cc.rotateBy(0,0),cc.rotateBy(e,360)));return this.bigCircle.runAction(t),t},userHandle:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){this.isGameOver||this.needleMove()},this)},needleMove:function(){var e=this;this.moveNeedle.active=!0,"level"===o.mode?this.needlesNum--:this.freeModeCurrNeedle++,this.waitNeedlesNumUpdate();var t=cc.sequence(cc.moveBy(.06,0,41),cc.moveTo(0,0,39),cc.callFunc(function(){e.moveNeedle.active=!1,e.createNeedles(),e.isGameOver||"level"!==o.mode||0!=e.needlesNum||(e.isGameOver=!0,e.gameLevelModeThislevelWin()),e.isGameOver||"free"!==o.mode||e.freeModeCurrScore++},this));this.moveNeedle.runAction(t)},waitNeedlesNumUpdate:function(){var e=this.waitContent.children;if("level"===o.mode)if(this.needlesNum>=6)for(var t=6;t>0;t--)e[6-t].getChildByName("wcTxt").getComponent(cc.Label).string=this.needlesNum-6+t;else{for(var i=this.needlesNum;i>0;i--)e[this.needlesNum-i].getChildByName("wcTxt").getComponent(cc.Label).string=i;for(var s=this.needlesNum;s<6;s++)e[s].active=!1}else for(var n=0;n<6;n++)e[n].getChildByName("wcTxt").getComponent(cc.Label).string=this.freeModeCurrNeedle+n+1},backStart:function(){cc.director.loadScene("game_needles_start")},gameOver:function(){this.isGameOver||(this.isGameOver=!0,this.bigCircle.stopAction(this.actionInts),this.bigCircle.children.filter(function(e){return"needle"==e.name}).forEach(function(e){e.getComponent("draw_needles").stopNeedleAction()}),this.gameOverShowInfoMask(),"free"===o.mode&&this.freeModeCurrScore===this.freeModeCurrNeedle&&this.freeModeCurrScore--)},gameOverShowInfoMask:function(){var e=this.gameInfoMask.getChildByName("gameMaskModeType"),t=this.gameInfoMask.getChildByName("freeModeBestScore"),i=this.gameInfoMask.getChildByName("levelModeTxt"),s=this.gameInfoMask.getChildByName("restart");e.getComponent(cc.Label).string=o.mode+" mode","level"===o.mode?(t.active=!1,i.active=!0,i.getComponent(cc.Label).string="level: "+o.gameLevel):(t.active=!0,i.active=!1,s.active=!0,this.freeModeCurrScore>o.freeBestScore&&(o.freeBestScore=this.freeModeCurrScore,this.requestDbNeedleFreeModeScore()),t.getComponent(cc.Label).string="best score: "+o.freeBestScore),this.gameOverMaskVis()},gameLevelModeThislevelWin:function(){var e=this.gameInfoMask.getChildByName("gameMaskModeType"),t=this.gameInfoMask.getChildByName("freeModeBestScore"),i=this.gameInfoMask.getChildByName("levelModeTxt"),s=this.gameInfoMask.getChildByName("restart"),n=this.gameInfoMask.getChildByName("next");e.getComponent(cc.Label).string=o.mode+" mode",t.active=!1,i.active=!0,s.active=!1,n.active=!0,o.gameLevel++,o.gameLevel>o.gameLevelData.length?(o.gameLevel=1,n.active=!1,i.getComponent(cc.Label).string="You have reached the last pass."):i.getComponent(cc.Label).string="level: "+o.gameLevel,this.requestDbNeedleLevelModeLevels(),this.gameOverMaskVis()},requestDbNeedleFreeModeScore:function(){s.GD.updateGameScore({needleFreeModeScore:o.freeBestScore},function(){s.GD.setUserGameInfo("needleFreeModeScore",o.freeBestScore),console.log("\u4fdd\u5b58\u6210\u529f")})},requestDbNeedleLevelModeLevels:function(){s.GD.updateGameScore({needleLevelModeLevels:o.gameLevel},function(){s.GD.setUserGameInfo("needleLevelModeLevels",o.gameLevel),console.log("\u4fdd\u5b58\u6210\u529f")})},gameOverMaskVis:function(){this.gameInfoMask.active=!0,this.gameInfoMask.opacity=0,this.gameInfoMask.runAction(cc.sequence(cc.scaleTo(0,.9,.9),cc.spawn(cc.scaleTo(.2,1,1),cc.fadeIn(.3))))},reLoadThisScene:function(){cc.director.loadScene("game_needles")},start:function(){this.modeTypeTxt.getComponent(cc.Label).string=o.mode+" mode","level"===o.mode&&(this.levelTxt.active=!0,this.levelTxt.getComponent(cc.Label).string="level: "+o.gameLevel),this.LevelSceneInit(),this.waitNeedlesNumUpdate(),this.userHandle()}}),cc._RF.pop()},{"../utils.js":"utils","./game_global.js":"game_global"}],obstacle:[function(e,t,i){"use strict";cc._RF.push(t,"e1966IPmbNFrrPSrBLrog4/","obstacle"),cc.Class({extends:cc.Component,properties:{obstaclePfb:{default:null,type:cc.Prefab},obstacleCount:0},onLoad:function(){if(this.obstacleInstance=[],this.isOnSnake=!0,this.snake=this.node.getComponent("snake").snakeArray,this.obstacleCount)for(var e=0;e<this.obstacleCount;e++)this.createObstacle()},getNumberInRange:function(e,t){var i=t-e,o=2*Math.random()-1;return Math.round(o*i+e)},createObstacle:function(){this.isOnSnake=!0;for(var e=void 0,t=[],i=Math.floor(2*Math.random());this.isOnSnake;){this.isOnSnake=!1;for(var o=e=15*this.getNumberInRange(0,this.node.width/30-1),s=15*this.getNumberInRange(0,this.node.height/30-1),n=0;n<i+1;n++){n%2==0&&(o=e,s-=15),o+=15;for(var c=0;c<this.snake.length;c++)if(this.snake[c].x==o&&this.snake[c].y==s){this.isOnSnake=!0;break}if((o<-(this.node.width/2-30)||o>this.node.width/2-30||s<-(this.node.height/2-30)||s>this.node.height/2-30)&&(this.isOnSnake=!0),this.isOnSnake)break;var a={x:o,y:s};t.push(a)}this.isOnSnake&&(t=[])}for(var r=0;r<t.length;r++){var h=cc.instantiate(this.obstaclePfb);this.node.addChild(h),h.setPosition(cc.p(t[r].x,t[r].y)),this.obstacleInstance.push(h)}}}),cc._RF.pop()},{}],pipe_group:[function(e,t,i){"use strict";cc._RF.push(t,"8326cSAlkJJQIP/wlrbFpEM","pipe_group"),cc.Class({extends:cc.Component,properties:{topPipeMinHeight:100,bottomPipeMinHeight:100,spacingMinValue:150,spacingMaxValue:200,topPipe:cc.Node,bottomPipe:cc.Node},init:function(e){this.pipeManager=e,this.initPositionX(),this.initPositionY()},initPositionX:function(){var e=cc.director.getVisibleSize(),t=-e.width/2,i=e.width/2;this.node.x=i+300,this.recylceX=t-Math.max(this.topPipe.width,this.bottomPipe.width)},initPositionY:function(){var e=cc.director.getVisibleSize().height/2-this.topPipeMinHeight,t=cc.find("Canvas/ground").y+cc.find("Canvas/ground").height/2+this.bottomPipeMinHeight,i=this.spacingMinValue+Math.random()*(this.spacingMaxValue-this.spacingMinValue);this.topPipe.y=e-Math.random()*(e-t-i),this.bottomPipe.y=this.topPipe.y-i},update:function(e){this.pipeManager.isRunning&&(this.node.x+=this.pipeManager.pipeMoveSpeed*e,this.node.x<this.recylceX&&this.pipeManager.recyclePipe(this))}}),cc._RF.pop()},{}],pipe_manager:[function(e,t,i){"use strict";cc._RF.push(t,"faf707MYslOt42pVSOmaVlA","pipe_manager");var o=e("pipe_group");cc.Class({extends:cc.Component,properties:{pipePrefab:cc.Prefab,pipeMoveSpeed:-300,pipeSpacing:300},onLoad:function(){this.pipeList=[],this.isRunning=!1,this.pipePool=new cc.NodePool;for(var e=0;e<3;++e){var t=cc.instantiate(this.pipePrefab);this.pipePool.put(t)}},startSpawn:function(){this.spawnPipe();var e=Math.abs(this.pipeSpacing/this.pipeMoveSpeed);this.schedule(this.spawnPipe,e),this.isRunning=!0},spawnPipe:function(){var e=null;e=this.pipePool.size()>0?this.pipePool.get().getComponent(o):cc.instantiate(this.pipePrefab).getComponent(o),this.node.addChild(e.node),e.node.active=!0,e.init(this),this.pipeList.push(e)},recyclePipe:function(e){e.node.active=!1,this.pipePool.put(e.node)},getNext:function(){return this.pipeList.shift()},reset:function(){this.unschedule(this.spawnPipe),this.pipeList=[],this.isRunning=!1}}),cc._RF.pop()},{pipe_group:"pipe_group"}],rect:[function(e,t,i){"use strict";cc._RF.push(t,"c7a33uqHoVKobpqpjjMbZ1/","rect"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.ctx=this.node.getComponent(cc.Graphics),this.drawRect()},drawRect:function(){this.ctx.clear(),this.ctx.rect(0,0,this.node.width,this.node.height),this.ctx.fill(),this.ctx.stroke()},update:function(e){this.drawRect()}}),cc._RF.pop()},{}],scroller:[function(e,t,i){"use strict";cc._RF.push(t,"b8267Clbu5ObKT5POZPTEWa","scroller"),cc.Class({extends:cc.Component,properties:{speed:-300,canvasNode:{default:null,type:cc.Node},longGround:{default:null,type:cc.Node}},onLoad:function(){this.canScroll=!0,this.resetX=-300},start:function(){this.resetX=-(this.canvasNode.width-100),this.longGround.width=this.canvasNode.width,this.longGround.x=this.canvasNode.width},update:function(e){this.canScroll&&(this.node.x+=this.speed*e,this.node.x<=this.resetX&&(this.node.x-=this.resetX))},stopScroll:function(){this.canScroll=!1},startScroll:function(){this.canScroll=!0}}),cc._RF.pop()},{}],skysc_block:[function(e,t,i){"use strict";cc._RF.push(t,"79cfci5BnZBEKzaiHjxocp7","skysc_block");var o=e("skysc_globals");cc.Class({extends:cc.Component,properties:{colliderSize:cc.size(55,58),spriptAni:cc.Animation},onLoad:function(){this.init()},init:function(){this.isFirstIn=!0,this.isFirstOut=!0,this.isDestroy=!0,this.node.group="skyscBlock"},onBeginContact:function(e,t,i){if(this.isFirstIn&&(t.node.getComponent(cc.RigidBody).linearVelocity=cc.p(0,0),this.isFirstIn=!1,1==o.gm.putCount&&(t.node.getComponent(cc.RigidBody).gravityScale=100,o.gm.handleResult()),this.spriptAni.play()),this.isDestroy&&200==i.tag&&1!=o.gm.putCount){this.isDestroy=!1;var s=t.node;this.isFirstOut&&(this.isFirstOut=!1,this.checkHp()),t.destroy(),this.scheduleOnce(function(){s.removeComponent(cc.RigidBody),s.removeComponent(cc.PhysicsBoxCollider),o.gm.backObjPool(s)},1.2)}},onPostSolve:function(e,t,i){101==t.tag&&102==i.tag&&(this.unschedule(this.checkDropCallFn),this.checkDropCallFn=function(e){if(this.isFirstOut){this.isFirstOut=!1;var s=t.body.getWorldCenter(),n=i.body.getWorldCenter(),c=Math.abs(Math.abs(s.x)-Math.abs(n.x));if(c<=i.node.width/2){var a=!1;c<=3&&(a=!0),o.gm.handleResult(a)}else this.checkHp()}}.bind(this),this.scheduleOnce(this.checkDropCallFn,.2))},checkHp:function(){o.gm.hp>0&&(o.gm.hp--,0==o.gm.hp?(o.gm.updateUi(),o.gm.gameOverHandle()):(o.gm.isSucceed=!1,o.gm.handleResult()))}}),cc._RF.pop()},{skysc_globals:"skysc_globals"}],skysc_globals:[function(e,t,i){"use strict";cc._RF.push(t,"d2896w+I+FKCoNWgzYzxzo5","skysc_globals"),t.exports={gm:null},cc._RF.pop()},{}],skysc_start:[function(e,t,i){"use strict";cc._RF.push(t,"dde99Ej+EJB747LAg1IAdNO","skysc_start"),cc.Class({extends:cc.Component,properties:{},backTheGameList:function(){cc.director.loadScene("startscene")},startGame:function(){cc.director.loadScene("skyscraper_game")}}),cc._RF.pop()},{}],skyscraper_game:[function(e,t,i){"use strict";cc._RF.push(t,"a378acgdjFGn41gXu2zOQRT","skyscraper_game");var o=e("skysc_globals"),s=e("../utils.js");cc.Class({extends:cc.Component,properties:{blockTmpCtn:{default:null,type:cc.Node},blockPb:{default:null,type:cc.Prefab},camera:{default:null,type:cc.Camera},cameraSpeed:200,crane:{default:null,type:cc.Node},craneRotation:{default:null,type:e("crane_rotate")},hpUi:{default:null,type:cc.Label},scoreUi:{default:null,type:cc.Label},hp:0,score:0,blockContainer:{default:null,type:cc.Node},gameOverMask:{default:null,type:cc.Node},maskCurrScore:{default:null,type:cc.Label},maskBestScore:{default:null,type:cc.Label}},onLoad:function(){var e=cc.director.getPhysicsManager();e.enabled=!0,e.debugDrawFlags=0,e.attachDebugDrawToCamera(this.camera),o.gm=this,this.state=1,this.isPut=!1,this.putCount=0,this.succeedPutCount=0,this.isSucceed=!0,this.prevBlock="",this.bestScore=s.GD.userGameInfo.skyscraperBestScore||0,this.node.on(cc.Node.EventType.TOUCH_END,this.putNext,this),this.poolBlock=new cc.NodePool;for(var t=0;t<15;t++){var i=cc.instantiate(this.blockPb);this.poolBlock.put(i)}},start:function(){this.craneRotation.craneStrRotate(),this.updateUi(),this.generateBlock()},generateBlock:function(){(this.crane.runAction(cc.fadeIn(.2)),this.waitBlock&&this.isSucceed)&&(this.waitBlock.getComponent(cc.RigidBody).type=cc.RigidBodyType.Static);this.poolBlock.size()>0?this.waitBlock=this.poolBlock.get():this.waitBlock=cc.instantiate(this.blockPb),this.blockJsComp=this.waitBlock.getComponent("skysc_block"),this.blockJsComp.init(),this.waitBlock.rotation=0,this.waitBlock.setPosition(cc.p(0,0)),this.waitBlock.parent=this.blockTmpCtn,this.isPut=!0,this.isSucceed=!0},backObjPool:function(e){this.poolBlock.put(e)},putNext:function(e){if(1==this.state&&this.isPut){this.crane.runAction(cc.fadeOut(.2)),this.isPut=!1,this.putCount++,this.waitBlock.rotation=0;var t=this.waitBlock.addComponent(cc.RigidBody),i=this.waitBlock.addComponent(cc.PhysicsBoxCollider);t.gravityScale=9.8,t.enabledContactListener=!0,t.type=cc.RigidBodyType.Dynamic,i.friction=1,i.size=this.blockJsComp.colliderSize,i.tag=101,i.apply(),this.waitBlock.parent=this.blockContainer}},move:function(){if(this.putCount>1&&this.succeedPutCount>=3){var e=this.succeedPutCount-2;e<0&&(e=0);var t=this.blockJsComp.colliderSize.height/this.cameraSpeed;this.camera.node.stopAllActions(),this.crane.stopAllActions();var i=cc.moveTo(t,cc.p(0,this.blockJsComp.colliderSize.height*e));this.crane.runAction(i),i=cc.moveTo(t,cc.p(0,this.blockJsComp.colliderSize.height*e)),this.camera.node.runAction(i)}},handleResult:function(e){var t=this;this.isSucceed&&(this.succeedPutCount++,this.craneRotation.switchDifficulty(),this.prevBlock&&(this.prevBlock.getComponent(cc.PhysicsBoxCollider).tag=100),this.waitBlock.getComponent(cc.PhysicsBoxCollider).tag=102,this.prevBlock=this.waitBlock,this.score=this.score+(e?10:1)),this.updateUi(),this.move(),this.scheduleOnce(function(){t.generateBlock()},.3)},updateUi:function(){this.hpUi.string=this.hp,this.scoreUi.string=this.score,this.maskCurrScore.string="Current score: "+this.score,this.maskBestScore.string="Best score: "+this.bestScore},gameOverHandle:function(){this.state=2,this.isPut=!1,this.score>this.bestScore&&(this.bestScore=this.score,this.updateBestScore()),this.gameOverMask.active=!0,this.gameOverMask.opacity=0,this.gameOverMask.runAction(cc.fadeIn(.3)),this.updateUi()},restartTheGame:function(){cc.director.loadScene("skyscraper_game")},backStartPage:function(){cc.director.loadScene("skyscraper_start")},updateBestScore:function(){var e=this;s.GD.updateGameScore({skyscraperBestScore:e.bestScore},function(){s.GD.setUserGameInfo("skyscraperBestScore",e.bestScore),console.log("\u4fdd\u5b58\u6210\u529f")})}}),cc._RF.pop()},{"../utils.js":"utils",crane_rotate:"crane_rotate",skysc_globals:"skysc_globals"}],snake_game:[function(e,t,i){"use strict";cc._RF.push(t,"280c3rsZJJKnZ9RqbALVwtK","snake_game"),cc.Class({extends:cc.Component,properties:{score:0,gameContainer:{default:null,type:cc.Node},gameInfo:{default:null,type:cc.Node}},onLoad:function(){this.gameContainer.width=this.node.width,this.gameContainer.height=this.node.height,this.snakeMoveSpeed=12,this.gameOver=!1,this.frames=0,this.snake=this.gameContainer.getComponent("snake")},showGameInfo:function(){this.gameInfo.active=!0,this.gameInfo.opacity=0,this.gameInfo.runAction(cc.fadeIn(.2))},update:function(e){if(this.gameOver)this.gameInfo.active||this.showGameInfo();else{switch(this.score){case 5:this.snakeMoveSpeed=10;break;case 10:this.snakeMoveSpeed=9;break;case 20:this.snakeMoveSpeed=8;break;case 50:this.snakeMoveSpeed=7;break;case 80:this.snakeMoveSpeed=6;break;case 100:this.snakeMoveSpeed=7;break;case 120:this.snakeMoveSpeed=8;break;case 200:this.snakeMoveSpeed=9;break;case 250:this.snakeMoveSpeed=8;break;case 280:this.snakeMoveSpeed=9;break;case 330:this.snakeMoveSpeed=8;break;case 380:this.snakeMoveSpeed=7;break;case 400:this.snakeMoveSpeed=9;break;case 450:this.snakeMoveSpeed=8}this.frames++,this.frames%this.snakeMoveSpeed==0&&this.snake.snakeMove()}}}),cc._RF.pop()},{}],snake:[function(e,t,i){"use strict";cc._RF.push(t,"26a8elULspEsJ3DRYvRGkOH","snake"),cc.Class({extends:cc.Component,properties:{DIFFPX:15,colorArr:[cc.String],canvas:{default:null,type:cc.Node},snakebody:{default:null,type:cc.Prefab},snakeHead:{default:null,type:cc.Prefab},currScore:{default:null,type:cc.Label}},onLoad:function(){this.snakeBodyPool=new cc.NodePool;for(var e=0;e<3;++e){var t=cc.instantiate(this.snakebody);this.snakeBodyPool.put(t)}this.snakeArray=[];for(var i=0;i<1;i++){var o=null;o=this.snakeBodyPool.size()>0?this.snakeBodyPool.get():cc.instantiate(this.snakebody),this.node.addChild(o),o.setPosition(cc.p(15*i,0)),this.snakeArray.splice(0,0,o)}var s=cc.instantiate(this.snakeHead);this.node.addChild(s),s.setPosition(cc.p(15,0)),this.snakeArray.splice(0,0,s),this.head=this.snakeArray[0],this.direction=39,this.touchX=0,this.touchY=0,this.game=this.canvas.getComponent("snake_game"),this.food=this.node.getComponent("food"),this.initEvent(),this.colorChange=0},snakeMove:function(){var e=null;if(e=this.snakeBodyPool.size()>0?this.snakeBodyPool.get():cc.instantiate(this.snakebody),this.node.addChild(e),e.setPosition(cc.p(this.head.x,this.head.y)),this.snakeArray.splice(1,0,e),this.isEat())this.game.score++,this.currScore.string="score:"+this.game.score,this.food.releaseFood(),this.food.foodPosShow();else{var t=this.snakeArray.pop();this.snakeBodyPool.put(t)}switch(this.direction){case 37:this.head.x-=this.head.width;break;case 38:this.head.y-=this.head.height;break;case 39:this.head.x+=this.head.width;break;case 40:this.head.y+=this.head.height}(this.head.x>=(this.node.width-15)/2||this.head.x<-this.node.width/2||this.head.y>=this.node.height/2||this.head.y<-this.node.height/2)&&(this.game.gameOver=!0);for(var i=1;i<this.snakeArray.length;i++)this.snakeArray[i].x==this.head.x&&this.snakeArray[i].y==this.head.y&&(this.game.gameOver=!0)},initEvent:function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_START,function(t){var i=t.getLocation(),o=i.x,s=i.y;e.touchX=o,e.touchY=s},this),this.node.on(cc.Node.EventType.TOUCH_END,function(t){var i=t.getLocation(),o=i.x,s=i.y,n=o-e.touchX,c=s-e.touchY;n<=-e.DIFFPX&&Math.abs(n)>=Math.abs(c)?39!==e.direction&&(e.direction=37):n>=e.DIFFPX&&Math.abs(n)>=Math.abs(c)?37!==e.direction&&(e.direction=39):c<=-e.DIFFPX&&Math.abs(c)>Math.abs(n)?40!==e.direction&&(e.direction=38):c>=e.DIFFPX&&Math.abs(c)>Math.abs(n)&&38!==e.direction&&(e.direction=40)},this)},isEat:function(){return this.head.x==this.food.foodX&&this.head.y==this.food.foodY}}),cc._RF.pop()},{}],start_js:[function(e,t,i){"use strict";cc._RF.push(t,"afc2dQHtItCX4XFZCnu2PdY","start_js");var o=[{title:" Aircraft war",name:"aircraft_war_start"},{title:" Fruit Ninja",name:"fruit_ninja_start"},{title:" Don't touch white block",name:"dontt_white_block_start"},{title:" Flappy bird",name:"flappy_bird"},{title:" Skyscraper",name:"skyscraper_start"},{title:" Needles",name:"game_needles_start"},{title:" Snake",name:"snake"},{title:" 2048",name:"game2048"},{title:" Tetris",name:"tetris"},{title:" Firework",name:"firework"},{title:" Follow the circle",name:"follow_the_circle"}],s=e("./utils.js");cc.Class({extends:cc.Component,properties:{gameBtnPfb:{default:null,type:cc.Prefab},content:{default:null,type:cc.Node},noticePic:{default:null,type:cc.Node},bottBanner:{default:null,type:cc.Node}},onLoad:function(){this.noticeOpen=!1,this.noticeLoadFirst=!0;for(var e=-65,t=0;t<o.length;t++){var i=cc.instantiate(this.gameBtnPfb),s=i.getComponent("game_start_btn");this.content.addChild(i),t>0&&(e-=65),s.updateItem(t,e,o[t].title,o[t].name)}this.content.height=Math.abs(e)+55},openNotice:function(){var e=this,t=120;e.noticeOpen?(e.noticeOpen=!1,t=-120):(e.noticeOpen=!0,t=120),e.noticeOpen&&e.noticeLoadFirst?(s.GD.showWxLoading(!0),e.loadNoticePic(function(){e.noticeMoveAction(t)})):e.noticeMoveAction(t)},noticeMoveAction:function(e){var t=cc.moveBy(.6,0,e).easing(cc.easeBounceOut(.6));this.bottBanner.runAction(t)},loadNoticePic:function(e){var t=this,i=t.noticePic.getComponent(cc.Sprite);s.GD.getIndexNoticePic(function(o){s.GD.showWxLoading(!1),o&&(t.noticeLoadFirst=!1,cc.loader.load(o.fileList[0].tempFileURL,function(e,o){o&&(i.spriteFrame=new cc.SpriteFrame(o),t.noticePic.parent.height=t.noticePic.height)})),e&&e()})}}),cc._RF.pop()},{"./utils.js":"utils"}],start:[function(e,t,i){"use strict";cc._RF.push(t,"28d22NtPmxBobTFoJ0BfiaM","start");var o=e("globals"),s=e("../utils.js");cc.Class({extends:cc.Component,properties:{loadingBg:{default:null,type:cc.Node}},onLoad:function(){cc.director.preloadScene("aircraft_war_game"),this.loadingBgAction(),s.GD.showWxLoading(!0),this.loadNoticePic()},startGame:function(){cc.director.loadScene("aircraft_war_game")},backList:function(){cc.director.loadScene("startscene")},loadingBgAction:function(){var e=cc.repeatForever(cc.sequence(cc.tintTo(.6,202,111,111),cc.tintTo(.6,206,154,114),cc.tintTo(.6,206,202,114),cc.tintTo(.6,118,206,114),cc.tintTo(.6,114,188,206),cc.tintTo(.6,114,136,206),cc.tintTo(.6,185,114,206)));this.loadingBg.runAction(e)},loadNoticePic:function(){var e=this.loadingBg.getComponent(cc.Sprite);o.loopBg?cc.loader.load(o.loopBg,function(t,i){t||(e.spriteFrame=new cc.SpriteFrame(i)),s.GD.showWxLoading(!1)}):s.GD.getAircaftWarBg(function(t){s.GD.showWxLoading(!1),t&&cc.loader.load(t.fileList[0].tempFileURL,function(t,i){t||(o.loopBg=i,e.spriteFrame=new cc.SpriteFrame(i))})})}}),cc._RF.pop()},{"../utils.js":"utils",globals:"globals"}],tetris_init:[function(e,t,i){"use strict";cc._RF.push(t,"dca63G0W+lGhZB5wMAKnzti","tetris_init");var o=e("./tetris_type.js"),s=e("../utils.js"),n="61/60/60/255";cc.Class({extends:cc.Component,properties:{theBoard:{type:cc.Node,default:null},scoreLabel:{type:cc.Label,default:null},gameOverInfo:{type:cc.Node,default:null},overScoreLabel:{type:cc.Label,default:null},bestScoreLabel:{type:cc.Label,default:null},previewBlock:{type:cc.Node,default:null}},onLoad:function(){this.ctx=this.theBoard.getComponent(cc.Graphics),this.previewCtx=this.previewBlock.getComponent(cc.Graphics),this.board=[],this.previewShapeBoard=[],this.SHAPES=[[o.Z,"236/38/66/255"],[o.S,"19/171/19/255"],[o.T,"221/219/61/255"],[o.O,"44/39/234/255"],[o.L,"234/131/39/255"],[o.I,"39/234/232/255"],[o.J,"128/57/209/255"]],this.fps=0,this.dropSpeed=500,this.score=0,this.gameOver=!1,this.x=3,this.y=-2,this.randomShape="",this.color="",this.rotateIdx=0,this.rotateShape="",this.bestScore=s.GD.userGameInfo.tetrisBestScore||0},randomOne:function(){var e=Math.floor(Math.random()*this.SHAPES.length);this.x=3,this.y=-2,this.randomShape=this.SHAPES[e][0],this.rotateIdx=Math.floor(Math.random()*this.randomShape.length),this.color=this.SHAPES[e][1],this.rotateShape=this.randomShape[this.rotateIdx],this.drawPreviewShape()},drawBoard:function(){this.ctx.clear();for(var e=0;e<20;e++)for(var t=0;t<10;t++)this.drawRect(t,e,this.board[e][t])},drawPreviewShape:function(){this.previewCtx.clear();for(var e=0;e<4;e++)for(var t=0;t<4;t++)this.previewShapeBoard[e][t]="255/255/255/10",this.rotateShape[e]&&this.rotateShape[e][t]&&(this.previewShapeBoard[e][t]=this.color),this.drawPreviewRect(t,e,this.previewShapeBoard[e][t])},drawPreviewRect:function(e,t,i){var o=i.split("/"),s=new cc.Color({r:parseInt(o[0]),g:parseInt(o[1]),b:parseInt(o[2]),a:parseInt(o[3])});this.previewCtx.fillColor=s,this.previewCtx.rect(18*e+2*e,62-(18*t+2*t),18,18),this.previewCtx.stroke(),this.previewCtx.fill()},drawRect:function(e,t,i){var o=i.split("/"),s=new cc.Color({r:parseInt(o[0]),g:parseInt(o[1]),b:parseInt(o[2]),a:parseInt(o[3])});this.ctx.fillColor=s,this.ctx.rect(18*e+2*e,382-(18*t+2*t),18,18),this.ctx.stroke(),this.ctx.fill()},fills:function(e){for(var t=0;t<this.rotateShape.length;t++)for(var i=0;i<this.rotateShape.length;i++)this.rotateShape[t][i]&&this.drawRect(this.x+i,this.y+t,e)},draw:function(){this.fills(this.color)},drawEmpty:function(){this.fills(n)},moveDown:function(){this.collisionDetection(0,1,this.rotateShape)?(this.drawOnBoard(),this.randomOne()):(this.drawEmpty(),this.y++,this.draw())},moveRight:function(){this.collisionDetection(1,0,this.rotateShape)||(this.drawEmpty(),this.x++,this.draw())},moveLeft:function(){this.collisionDetection(-1,0,this.rotateShape)||(this.drawEmpty(),this.x--,this.draw())},rotate:function(){var e=this.randomShape[(this.rotateIdx+1)%this.randomShape.length],t=0;this.collisionDetection(0,0,e)&&(t=this.x>5?-1:1),this.collisionDetection(t,0,e)||(this.drawEmpty(),this.x+=t,this.rotateIdx=(this.rotateIdx+1)%this.randomShape.length,this.rotateShape=this.randomShape[this.rotateIdx],this.draw())},drawOnBoard:function(){this.dropSpeed=500;for(var e=0;e<this.rotateShape.length;e++)for(var t=0;t<this.rotateShape.length;t++)if(this.rotateShape[e][t]){if(this.y+e<0){this.gameOver=!0,this.score>this.bestScore&&(this.bestScore=this.score,this.requestDbTetrisBestScore()),this.showGameOverInfo();break}this.board[this.y+e][this.x+t]=this.color}for(var i=0;i<20;i++){for(var o=!0,s=0;s<10;s++)o=o&&this.board[i][s]!=n;if(o){for(var c=i;c>1;c--)for(var a=0;a<10;a++)this.board[c][a]=this.board[c-1][a];for(var r=0;r<10;r++)this.board[0][r]=n;this.score+=10}}this.drawBoard(),this.scoreLabel.string="score:"+this.score},collisionDetection:function(e,t,i){for(var o=0;o<i.length;o++)for(var s=0;s<i.length;s++)if(i[o][s]){var c=this.x+s+e,a=this.y+o+t;if(c<0||c>=10||a>=20)return!0;if(!(a<0)&&this.board[a][c]!=n)return!0}return!1},initEvent:function(){var e=this,t=void 0,i=void 0,o=void 0,s=void 0;this.node.on(cc.Node.EventType.TOUCH_START,function(e){var n=e.getLocation();t=n.x,i=n.y,o=0,s=0},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var n=e.getLocation(),c=n.x,a=n.y,r=c-t,h=a-i;(Math.abs(r)>12||Math.abs(h/r)>2)&&(o=r),(Math.abs(h)>12||Math.abs(r/h)>2)&&(s=h)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(t){e.gameOver||(s>25&&Math.abs(s/o)>2&&e.rotate(),s<-25&&Math.abs(s/o)>2&&(e.dropSpeed=0,e.moveDown()),o<-25&&Math.abs(o/s)>2&&e.moveLeft(),o>25&&Math.abs(o/s)>2&&e.moveRight())},this)},requestDbTetrisBestScore:function(e){var t=this;s.GD.updateGameScore({tetrisBestScore:t.score},function(){s.GD.setUserGameInfo("tetrisBestScore",t.score),e&&e(),console.log("\u4fdd\u5b58\u6210\u529f")})},showGameOverInfo:function(){this.overScoreLabel.string="score: "+this.score,this.bestScoreLabel.string="best score: "+this.bestScore,this.gameOverInfo.active=!0,this.gameOverInfo.opacity=0,this.gameOverInfo.runAction(cc.sequence(cc.scaleTo(0,.9,.9),cc.spawn(cc.scaleTo(.2,1,1),cc.fadeIn(.3))))},newGame:function(){this.gameOverInfo.active=!1,this.fps=0,this.dropSpeed=500,this.score=0,this.gameOver=!1,this.scoreLabel.string="score:"+this.score;for(var e=0;e<20;e++){this.board[e]=[];for(var t=0;t<10;t++)this.board[e][t]=n}this.drawBoard(),this.randomOne()},backList:function(){this.score>this.bestScore?(this.bestScore=this.score,this.requestDbTetrisBestScore(function(){cc.director.loadScene("startscene")})):cc.director.loadScene("startscene")},start:function(){for(var e=0;e<20;e++){this.board[e]=[];for(var t=0;t<10;t++)this.board[e][t]=n}for(var i=0;i<4;i++){this.previewShapeBoard[i]=[];for(var o=0;o<4;o++)this.previewShapeBoard[i][o]="255/255/255/10"}this.scoreLabel.string="score:"+this.score,this.drawBoard(),this.randomOne(),this.initEvent()},update:function(e){this.fps+=1e3*e,this.fps>this.dropSpeed&&(this.fps=0,this.gameOver||this.moveDown())}}),cc._RF.pop()},{"../utils.js":"utils","./tetris_type.js":"tetris_type"}],tetris_type:[function(e,t,i){"use strict";cc._RF.push(t,"93c0ajbIXhJIIFREPDB8piZ","tetris_type"),t.exports={T:[[[0,1,0],[1,1,1],[0,0,0]],[[0,1,0],[0,1,1],[0,1,0]],[[0,0,0],[1,1,1],[0,1,0]],[[0,1,0],[1,1,0],[0,1,0]]],J:[[[1,0,0],[1,1,1],[0,0,0]],[[0,1,1],[0,1,0],[0,1,0]],[[0,0,0],[1,1,1],[0,0,1]],[[0,1,0],[0,1,0],[1,1,0]]],L:[[[0,0,1],[1,1,1],[0,0,0]],[[0,1,0],[0,1,0],[0,1,1]],[[0,0,0],[1,1,1],[1,0,0]],[[1,1,0],[0,1,0],[0,1,0]]],O:[[[0,0,0,0],[0,1,1,0],[0,1,1,0],[0,0,0,0]]],I:[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[0,0,1,0],[0,0,1,0],[0,0,1,0],[0,0,1,0]],[[0,0,0,0],[0,0,0,0],[1,1,1,1],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],S:[[[0,1,1],[1,1,0],[0,0,0]],[[0,1,0],[0,1,1],[0,0,1]],[[0,0,0],[0,1,1],[1,1,0]],[[1,0,0],[1,1,0],[0,1,0]]],Z:[[[1,1,0],[0,1,1],[0,0,0]],[[0,0,1],[0,1,1],[0,1,0]],[[0,0,0],[1,1,0],[0,1,1]],[[0,1,0],[1,1,0],[1,0,0]]]},cc._RF.pop()},{}],utils:[function(e,t,i){"use strict";cc._RF.push(t,"76bdfhm93ZOOb8AnKuDLDR9","utils"),t.exports={GD:null,batchInitObjPool:function(e,t){for(var i=0;i<t.length;i++){var o=t[i];this.initObjPool(e,o)}},initObjPool:function(e,t){var i=t.name+"Pool";e[i]=new cc.NodePool;for(var o=t.initPoolCount,s=0;s<o;++s){var n=cc.instantiate(t.prefab);e[i].put(n)}},genNewNode:function(e,t,i){var o=null;return o=e.size()>0?e.get():cc.instantiate(t),i.addChild(o),o},backObjPool:function(e,t,i){e[t].put(i)},random:function(e,t){return Math.random()*(t-e)+e}},cc._RF.pop()},{}]},{},["buff","buff_group","bullet","bullet_group","common","enemy","enemy_bullet","enemy_bullet_group","enemy_collision","enemy_group","gamescene_bg","globals","hero","main","start","bird","bird_game_start","fb_game","pipe_group","pipe_manager","scroller","block_row","dtwb_game","dtwb_start_page","draw_animation_bg","firework_body","firework_init_js","circle_group","circle_item","ftc_start","fruit_game_start","fruit_juice","fruit_juice_group","fruit_ninja_fruit","fruit_ninja_game","fruit_ninja_group","2048_start","game_start_btn","game_user_js","draw_needles","game_global","needleCollider","needles_draw_circle","needles_init","needles_main","crane_rotate","skysc_block","skysc_globals","skysc_start","skyscraper_game","food","game_info","headColliderListener","obstacle","rect","snake","snake_game","start_js","tetris_init","tetris_type","utils"]);